/*! For license information please see bundle.41f9a0721aaf0fc78e0d.js.LICENSE.txt */
(()=>{"use strict";var t={507:(t,e,a)=>{a.d(e,{Z:()=>s});var n=a(81),o=a.n(n),r=a(645),i=a.n(r)()(o());i.push([t.id,'.nav-pagination{text-align:left;width:auto;display:block;text-align:center;margin:50px auto;width:700px}.nav-pagination ul.pagination{display:block}.nav-pagination ul.pagination li{border-radius:0px !important;display:inline-block}.controllerTool .cancelEditGood{display:none}.isChanged .controllerTool .cancelEditGood{display:inline-block}.baseTableShop{list-style-type:none;padding:0;margin:0;margin-top:20px}.baseTableShop li{display:block;padding-bottom:5px;white-space:nowrap}.baseTableShop li>span{vertical-align:middle;display:inline-block;white-space:nowrap;text-overflow:ellipsis}.baseTableShop .colName{min-width:300px;font-weight:bold;margin-right:13px}.baseTableShop .colName .colEdit{min-width:300px !important}.baseTableShop .colID{min-width:45px}.baseTableShop .colData{min-width:35px;margin-right:5px}.baseTableShop .colEdit{display:none;min-width:30px}.baseTableShop .isEditing .colEdit{display:block}.baseTableShop .isEditing .colDisplay{display:none}.baseTableShop .dataRow:hover{background-color:#ececec}.baseTableShop .colShopCounter{min-width:30px}#goodsTable .colData,#buysellTable .colData{min-width:80px;max-width:80px}#goodsTable .colEdit,#buysellTable .colEdit{min-width:80px;max-width:80px}#buysellTable .colData .colEdit{display:none !important}#buysellTable .colData .colDisplay{display:inline-block !important}#itemViewer .colSpr,#itemViewer .colScript{min-width:300px !important}#itemViewer .colType{min-width:250px !important}#itemViewer .colID:hover{cursor:pointer}.select2-container--default .select2-selection--single{font-weight:normal}.buysellEditorContainer{border:1px solid #ececec;overflow:auto}.buysellEditorContainer .colChose{display:none !important}#buysell-addGoods{margin-top:20px}.addMoreShop{margin-top:20px;width:600px}.flash-row{background-color:#cfe2ff}.dataRow{transition:background-color 500ms ease}.downloadMagicScriptContainer{text-align:center;margin:20px}#magicscriptTable{display:table}#magicscriptTable>li{display:table-row}#magicscriptTable>li>span{display:table-cell;padding:3px}#magicscriptTable .firstRow span{vertical-align:bottom;white-space:normal;text-align:left}#magicscriptTable .rowData[forCol="9"],#magicscriptTable .rowData[forCol="11"],#magicscriptTable .rowData[forCol="16"],#magicscriptTable .rowData[forCol="17"],#magicscriptTable .rowData[forCol="19"]{display:none}#magicscriptTable .isNumber .form-control{width:35px}#magicscriptTable .isNumber .form-control[forCol=\'3\']{width:70px}#magicscriptTable .isText .form-control{width:350px}#magicscriptTable .rowData.isNumber[forCol="5"] .form-control{width:70px}.formQuickEdit{white-space:nowrap}.formQuickEdit div{margin-right:20px;display:inline-block;vertical-align:middle}.popover{--bs-popover-max-width: 500px}\n',""]);const s=i},800:(t,e,a)=>{a.d(e,{Z:()=>s});var n=a(81),o=a.n(n),r=a(645),i=a.n(r)()(o());i.push([t.id,".pageMain{padding:20px}.controllerContainer{background-color:#ececec;padding:20px;margin:20px 0px}.dataContainer{padding:20px}#readProgressBar{margin-top:20px}.exportSection{text-align:center;margin-top:20px}#page2{display:none}body.loadedData #page1{display:none}body.loadedData #page2{display:block}footer{font-weight:normal;color:#bbb}.pageMain{margin:auto}#uploadButton{display:none}\n",""]);const s=i},645:t=>{t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var a="",n=void 0!==e[5];return e[4]&&(a+="@supports (".concat(e[4],") {")),e[2]&&(a+="@media ".concat(e[2]," {")),n&&(a+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),a+=t(e),n&&(a+="}"),e[2]&&(a+="}"),e[4]&&(a+="}"),a})).join("")},e.i=function(t,a,n,o,r){"string"==typeof t&&(t=[[null,t,void 0]]);var i={};if(n)for(var s=0;s<this.length;s++){var c=this[s][0];null!=c&&(i[c]=!0)}for(var l=0;l<t.length;l++){var u=[].concat(t[l]);n&&i[u[0]]||(void 0!==r&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=r),a&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=a):u[2]=a),o&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=o):u[4]="".concat(o)),e.push(u))}},e}},81:t=>{t.exports=function(t){return t[1]}},379:t=>{var e=[];function a(t){for(var a=-1,n=0;n<e.length;n++)if(e[n].identifier===t){a=n;break}return a}function n(t,n){for(var r={},i=[],s=0;s<t.length;s++){var c=t[s],l=n.base?c[0]+n.base:c[0],u=r[l]||0,p="".concat(l," ").concat(u);r[l]=u+1;var d=a(p),f={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==d)e[d].references++,e[d].updater(f);else{var h=o(f,n);n.byIndex=s,e.splice(s,0,{identifier:p,updater:h,references:1})}i.push(p)}return i}function o(t,e){var a=e.domAPI(e);return a.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;a.update(t=e)}else a.remove()}}t.exports=function(t,o){var r=n(t=t||[],o=o||{});return function(t){t=t||[];for(var i=0;i<r.length;i++){var s=a(r[i]);e[s].references--}for(var c=n(t,o),l=0;l<r.length;l++){var u=a(r[l]);0===e[u].references&&(e[u].updater(),e.splice(u,1))}r=c}}},569:t=>{var e={};t.exports=function(t,a){var n=function(t){if(void 0===e[t]){var a=document.querySelector(t);if(window.HTMLIFrameElement&&a instanceof window.HTMLIFrameElement)try{a=a.contentDocument.head}catch(t){a=null}e[t]=a}return e[t]}(t);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");n.appendChild(a)}},216:t=>{t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},565:(t,e,a)=>{t.exports=function(t){var e=a.nc;e&&t.setAttribute("nonce",e)}},795:t=>{t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(a){!function(t,e,a){var n="";a.supports&&(n+="@supports (".concat(a.supports,") {")),a.media&&(n+="@media ".concat(a.media," {"));var o=void 0!==a.layer;o&&(n+="@layer".concat(a.layer.length>0?" ".concat(a.layer):""," {")),n+=a.css,o&&(n+="}"),a.media&&(n+="}"),a.supports&&(n+="}");var r=a.sourceMap;r&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),e.styleTagTransform(n,t,e.options)}(e,t,a)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},589:t=>{t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},702:function(t,e,a){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.VietnameseConversion=void 0;var o=n(a(926)),r=function(){function t(t,e){if(this._charsets=o.default,!this.isValidCharset(e))throw Error("Charset is not valid");this._text=t,this._chartset=e.toUpperCase()}return t.prototype.isValidCharset=function(t){return Object.keys(this._charsets).indexOf(t.toUpperCase())>-1},t.prototype.getCharsArray=function(t){return this._charsets[t]},t.prototype.toCharset=function(t){if(!this.isValidCharset(t))throw Error("Charset is not valid");if(this._chartset===t.toUpperCase())return this._text;for(var e=this.getCharsArray(this._chartset),a=this.getCharsArray(t.toUpperCase()),n=e.length,o=this._text,r=0;r<n;r++){var i=e[r],s=new RegExp(i,"g");o=o.replace(s,"::"+r+"::")}for(r=0;r<n;r++)i=a[r],s=new RegExp("::"+r+"::","g"),o=o.replace(s,i);return o},t}();e.VietnameseConversion=r,e.default=r},926:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});e.default={UNICODE:["À","Á","Â","Ã","È","É","Ê","Ì","Í","Ò","Ó","Ô","Õ","Ù","Ú","Ý","à","á","â","ã","è","é","ê","ì","í","ò","ó","ô","õ","ù","ú","ý","Ă","ă","Đ","đ","Ĩ","ĩ","Ũ","ũ","Ơ","ơ","Ư","ư","Ạ","ạ","Ả","ả","Ấ","ấ","Ầ","ầ","Ẩ","ẩ","Ẫ","ẫ","Ậ","ậ","Ắ","ắ","Ằ","ằ","Ẳ","ẳ","Ẵ","ẵ","Ặ","ặ","Ẹ","ẹ","Ẻ","ẻ","Ẽ","ẽ","Ế","ế","Ề","ề","Ể","ể","Ễ","ễ","Ệ","ệ","Ỉ","ỉ","Ị","ị","Ọ","ọ","Ỏ","ỏ","Ố","ố","Ồ","ồ","Ổ","ổ","Ỗ","ỗ","Ộ","ộ","Ớ","ớ","Ờ","ờ","Ở","ở","Ỡ","ỡ","Ợ","ợ","Ụ","ụ","Ủ","ủ","Ứ","ứ","Ừ","ừ","Ử","ử","Ữ","ữ","Ự","ự","Ỳ","ỳ","Ỵ","ỵ","Ỷ","ỷ","Ỹ","ỹ"],VNI:["AØ","AÙ","AÂ","AÕ","EØ","EÙ","EÂ","Ì","Í","OØ","OÙ","OÂ","OÕ","UØ","UÙ","YÙ","aø","aù","aâ","aõ","eø","eù","eâ","ì","í","oø","où","oâ","oõ","uø","uù","yù","AÊ","aê","Ñ","ñ","Ó","ó","UÕ","uõ","Ô","ô","Ö","ö","AÏ","aï","AÛ","aû","AÁ","aá","AÀ","aà","AÅ","aå","AÃ","aã","AÄ","aä","AÉ","aé","AÈ","aè","AÚ","aú","AÜ","aü","AË","aë","EÏ","eï","EÛ","eû","EÕ","eõ","EÁ","eá","EÀ","eà","EÅ","eå","EÃ","eã","EÄ","eä","Æ","æ","Ò","ò","OÏ","oï","OÛ","oû","OÁ","oá","OÀ","oà","OÅ","oå","OÃ","oã","OÄ","oä","ÔÙ","ôù","ÔØ","ôø","ÔÛ","ôû","ÔÕ","ôõ","ÔÏ","ôï","UÏ","uï","UÛ","uû","ÖÙ","öù","ÖØ","öø","ÖÛ","öû","ÖÕ","öõ","ÖÏ","öï","YØ","yø","Î","î","YÛ","yû","YÕ","yõ"],TCVN3:["Aµ","A¸","¢","A·","EÌ","EÐ","£","I×","IÝ","Oß","Oã","¤","Oâ","Uï","Uó","Yý","µ","¸","©","·","Ì","Ð","ª","×","Ý","ß","ã","«","â","ï","ó","ý","¡","¨","§","®","IÜ","Ü","Uò","ò","¥","¬","¦","­","A¹","¹","A¶","¶","¢Ê","Ê","¢Ç","Ç","¢È","È","¢É","É","¢Ë","Ë","¡¾","¾","¡»","»","¡¼","¼","¡½","½","¡Æ","Æ","EÑ","Ñ","EÎ","Î","EÏ","Ï","£Õ","Õ","£Ò","Ò","£Ó","Ó","£Ô","Ô","£Ö","Ö","IØ","Ø","IÞ","Þ","Oä","ä","Oá","á","¤è","è","¤å","å","¤æ","æ","¤ç","ç","¤é","é","¥í","í","¥ê","ê","¥ë","ë","¥ì","ì","¥î","î","Uô","ô","Uñ","ñ","¦ø","ø","¦õ","õ","¦ö","ö","¦÷","÷","¦ù","ù","Yú","ú","Yþ","þ","Yû","û","Yü","ü"],VIQR:["A`","A'","A^","A~","E`","E'","E^","I`","I'","O`","O'","O^","O~","U`","U'","Y'","a`","a'","a^","a~","e`","e'","e^","i`","i'","o`","o'","o^","o~","u`","u'","y'","A(","a(","DD","dd","I~","i~","U~","u~","O+","o+","U+","u+","A.","a.","A?","a?","A^'","a^'","A^`","a^`","A^?","a^?","A^~","a^~","A^.","a^.","A('","a('","A(`","a(`","A(?","a(?","A(~","a(~","A(.","a(.","E.","e.","E?","e?","E~","e~","E^'","e^'","E^`","e^`","E^?","e^?","E^~","e^~","E^.","e^.","I?","i?","I.","i.","O.","o.","O?","o?","O^'","o^'","O^`","o^`","O^?","o^?","O^~","o^~","O^.","o^.","O+'","o+'","O+`","o+`","O+?","o+?","O+~","o+~","O+.","o+.","U.","u.","U?","u?","U+'","u+'","U+`","u+`","U+?","u+?","U+~","u+~","U+.","u+.","Y`","y`","Y.","y.","Y?","y?","Y~","y~"]}},658:function(t,e,a){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.toVIQR=e.toTCVN3=e.toVNI=e.toUnicode=void 0;var o=n(a(702));e.toUnicode=function(t,e){return new o.default(t,e).toCharset("unicode")},e.toVNI=function(t,e){return new o.default(t,e).toCharset("vni")},e.toTCVN3=function(t,e){return new o.default(t,e).toCharset("tcvn3")},e.toVIQR=function(t,e){return new o.default(t,e).toCharset("viqr")}},384:function(t,e,a){var n=this&&this.__createBinding||(Object.create?function(t,e,a,n){void 0===n&&(n=a),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[a]}})}:function(t,e,a,n){void 0===n&&(n=a),t[n]=e[a]}),o=this&&this.__exportStar||function(t,e){for(var a in t)"default"===a||Object.prototype.hasOwnProperty.call(e,a)||n(e,t,a)},r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.VietnameseConversion=void 0;var i=a(702);Object.defineProperty(e,"VietnameseConversion",{enumerable:!0,get:function(){return r(i).default}}),o(a(658),e)}},e={};function a(n){var o=e[n];if(void 0!==o)return o.exports;var r=e[n]={id:n,exports:{}};return t[n].call(r.exports,r,r.exports,a),r.exports}a.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return a.d(e,{a:e}),e},a.d=(t,e)=>{for(var n in e)a.o(e,n)&&!a.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},a.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),a.nc=void 0,(()=>{var t=a(379),e=a.n(t),n=a(795),o=a.n(n),r=a(569),i=a.n(r),s=a(565),c=a.n(s),l=a(216),u=a.n(l),p=a(589),d=a.n(p),f=a(800),h={};h.styleTagTransform=d(),h.setAttributes=c(),h.insert=i().bind(null,"head"),h.domAPI=o(),h.insertStyleElement=u(),e()(f.Z,h),f.Z&&f.Z.locals&&f.Z.locals;var g={},m={};const v={on:function(t,e,a){a?m[a]=e:(g[t]=g[t]||[],g[t].push(e))},trigger:function(t,e,a){if(a){if(!m[a])return;m[a](e)}else{if(!g[t])return;g[t].forEach((function(t){return t(e)}))}}};$(document).on("select2:open",(function(){document.querySelector(".select2-search__field").focus()})),window.llGlobal={minimumInputLength:1,width:"100%",placeholder:{id:"",placeholder:"Tìm"},language:{inputTooShort:function(){return"Gõ ít nhất 1 chữ"}}},window.llEvents=v;var y={isDEV:!1,data:{},searchCache:{},getSearchToken:function(t,e){return y.searchCache[t]||(y.searchCache[t]=(t.replace(/_/g," ")+e.name+e.spr).toLowerCase()),y.searchCache[t]},addItemToCachePool:function(t,e,a){if(e.length<3)return!0;"goldequip"===t&&(e[1]=16,e[2]=a,e[3]=1);var n=e[1],o=e[2],r="questkey"==t?e[9]:e[3],i={__type:""+t,__source:"",name:""+e[0],genre:n,type:o,spec:r,kind:"huangjintupu"==t?"":"questkey"==t?0:e[9],spr:"huangjintupu"==t?"":"questkey"==t?e[3]:e[4],level:"huangjintupu"==t?"":"questkey"==t?0:e[11],script:e[13]||""},s=[i.genre,i.type,i.spec||0,""!==i.kind&&i.kind||0,""!==i.level&&i.level||0].join("_");i.code=s,y.data.allItems[s]=i},onCachePoolReady:function(){$.each(y.data.allItems,(function(t,e){var a=e.__type;y.data.allItemKeysByType[a]||(y.data.allItemKeysByType[a]=[]),y.data.allItemKeysByType[a].push(t)}));var t=Object.keys(y.data.allItems);t.sort(),y.data.allItemsKey=t}};const b=y;var w,x=1,D="all",C={horse:"Ngựa",mask:"Mặt nạ",questkey:"Vật phẩm NV",boot:"Giày",armor:"Áo",amulet:"Dây chuyền",ring:"Nhẫn",rangeweapon:"VK tầm xa",meleeweapon:"VK cận chiến",helm:"Nón",belt:"Thắt lưng",potion:"Thuốc",cuff:"Bao tay",pendant:"Ngọc bội",magicscript:"Vật phẩm",huangjintupu:"Đồ phổ",goldequip:"Đồ HK",platinaequip:"Đồ BK"},E=function(t){return C[t]?C[t]+" - "+t+" ":t},I=function(t){var e="<li class='dataRow isEditing' forID='"+t.code+"'>",a=E(t.__type),n=t.isFirstRow?t.code:[t.genre,t.type,t.spec].join(" "),o=t.isFirstRow?t.name:H.helpers.t2u(t.name);return(e+='\n \n\n\t\t<span class="colChose" title="Thêm vào danh sách vật phẩm bán (goods.txt)">\n\t\t\t'.concat(t.isFirstRow?"":'<button class=\'btn btn-primary btn-sm add2Goods\' data-bs-container="body" data-bs-toggle="popover" data-bs-placement="top" data-bs-content="Đã thêm vào ds vật phẩm bán (goods.txt)">+</button>','\n\t\t</span>\n        <span class="colID colData" forValue=\'').concat(n,"'>\n            ").concat(n," \n            ").concat(t.kind,'\n        </span>\n        <span class="colLevel colData" title=\'').concat(t.level,"'>\n            ").concat(t.level,'\n        </span>\n        <span class="colType" title=\'').concat(a,'\'> \n            <span class="colDisplay">').concat(a," ").concat(t.isFirstRow?"":t.__source,'</span>\n            <span class="colEdit">').concat(a," ").concat(t.isFirstRow?"":t.__source,' </span>\n        </span>\n        <span class="colName" title=\'').concat(t.code,'\'> \n            <span class="colDisplay">').concat(o,'</span>\n            <span class="colEdit">').concat(o,' </span>\n        </span>\n\n        <span class="colSpr" title=\'').concat(t.spr,'\'> \n            <span class="colDisplay">').concat(t.spr,'</span>\n            <span class="colEdit">').concat(t.spr,' </span>\n        </span>\n\n        <span class="colScript" title=\'').concat("magicscript"!==a?"":t.script,'\'> \n            <span class="colDisplay">').concat("magicscript"!==a?"":t.script,'</span>\n            <span class="colEdit">').concat("magicscript"!==a?"":t.script," </span>\n        </span>\n\t\t\n    "))+"</li>"},T=!1,S={show:function(t,e){t&&(w=t),e&&(x=e),function(){if(!T){T=!0,$("#itemViewerPagination").on("click",".page-link",(function(t){t.preventDefault(),t.stopPropagation(),S.show(!1,$(this).attr("forPage"))})),$("#itemFilterSelect").on("change",(function(t){D=$(this).val(),x=1,S.show()}));var t=_.debounce((function(){S.show()}),1e3);$("#item-viewers-tab-pane").on("keyup","#filterByName",t),w.on("click",".add2Goods",(function(){var t=$(this).closest(".dataRow"),e=t.attr("forID"),a=Array(b.data.goodsData[b.data.goodsData.length-1].length).fill(""),n=JSON.parse(JSON.stringify(b.data.allItems[e]));a[26]=n.name,a[0]=n.genre,a[1]=n.type,a[2]=n.spec,a[3]=n.kind,a[4]=n.level,t.addClass("flash-row"),b.data.goodsData.push(a),llEvents.trigger("goods.changed")}))}}();var a=D&&"all"!==D?b.data.allItemKeysByType[D]:b.data.allItemsKey,n=H.helpers.u2t($("#filterByName").val());if(""!==n){var o=[];n=n.toLowerCase(),$.each(a,(function(t,e){var a=b.data.allItems[e];-1!==b.getSearchToken(e,a).indexOf(n)&&o.push(e)})),a=o}if(!a)return!0;!function(t){var e=[];$.each(b.data.allItemKeysByType,(function(t,a){a.length>0&&e.push({label:E(t)+" (".concat(a.length,")"),value:t})})),e.sort((function(t,e){return t.label.localeCompare(e.label)}));var a=$("#itemFilterSelect");a.html('<option value="all" '+"".concat("all"===t?"selected":"")+">Tất cả</option>"),e.forEach((function(e){a.append("<option value='".concat(e.value,"' ").concat(e.value===t?"selected":"",">").concat(e.label,"</option>"))}))}(D);var r=Math.ceil(a.length/100);x>r&&(x=r);for(var i=$("#itemViewerPagination"),s=$('<ul class="pagination"></ul>'),c=1;c<=r;c++)s.append('<li class="page-item '+(c==x?"active":"")+'" ><a class="page-link" href="#" forPage="'+c+'">'+c+"</a></li>");i.empty().append(s);var l=100*(x-1),u=Math.min(l+100,a.length),p=a.slice(l,u),d="<ul id='itemsTable' class='baseTableShop'>";d+=I({name:"Tên",index:"ID",isFirstRow:!0,code:"ID",__type:"Loại",level:"Cấp",spr:"Hình",script:"Script",kind:"NH"}),p.forEach((function(t,e){var a=b.data.allItems[t];d+=I(a)})),d+="</ul>",w.empty().append($(d)),document.querySelectorAll('[data-bs-toggle="popover"]').forEach((function(t){t.hasAttribute("data-bs-popover-initialized")||(t.setAttribute("data-bs-popover-initialized","true"),new bootstrap.Popover(t),t.addEventListener("shown.bs.popover",(function(){var e=bootstrap.Popover.getInstance(t);setTimeout((function(){e.hide()}),2e3)})))}))}};const O=S;function k(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,n=new Array(e);a<e;a++)n[a]=t[a];return n}var A=a(384),N=A.toUnicode,P=A.toTCVN3;const R={t2u:function(t){return N(t,"tcvn3")},u2t:function(t){return P(t,"unicode")},getFileName:function(t){var e=t.split(/[\\/]/);return e[e.length-1]},parseCSVRow:function(t){return t.split("\t").map((function(t){var e=parseFloat(t);return isNaN(e)||String(e)!==t?"true"===t||"false"===t?"true"===t:t:e}))},arrayToCSV:function(t){var e,a=Math.max.apply(Math,function(t){if(Array.isArray(t))return k(t)}(e=t.map((function(t){return t.length})))||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(e)||function(t,e){if(t){if("string"==typeof t)return k(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?k(t,e):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());return t.map((function(t){for(;t.length<a;)t.push("");return t})).map((function(t){return t.join("\t")})).join("\r\n")}},L=(String.fromCharCode,new Map([[129,1],[141,13],[143,15],[144,16],[157,29],[160,32],[161,33],[162,34],[163,35],[164,36],[165,37],[166,38],[167,39],[168,40],[169,41],[170,42],[171,43],[172,44],[173,45],[174,46],[175,47],[176,48],[177,49],[178,50],[179,51],[180,52],[181,53],[182,54],[183,55],[184,56],[185,57],[186,58],[187,59],[188,60],[189,61],[190,62],[191,63],[192,64],[193,65],[194,66],[195,67],[196,68],[197,69],[198,70],[199,71],[200,72],[201,73],[202,74],[203,75],[204,76],[205,77],[206,78],[207,79],[208,80],[209,81],[210,82],[211,83],[212,84],[213,85],[214,86],[215,87],[216,88],[217,89],[218,90],[219,91],[220,92],[221,93],[222,94],[223,95],[224,96],[225,97],[226,98],[227,99],[228,100],[229,101],[230,102],[231,103],[232,104],[233,105],[234,106],[235,107],[236,108],[237,109],[238,110],[239,111],[240,112],[241,113],[242,114],[243,115],[244,116],[245,117],[246,118],[247,119],[248,120],[249,121],[250,122],[251,123],[252,124],[253,125],[254,126],[255,127],[338,12],[339,28],[352,10],[353,26],[376,31],[381,14],[382,30],[402,3],[710,8],[732,24],[8211,22],[8212,23],[8216,17],[8217,18],[8218,2],[8220,19],[8221,20],[8222,4],[8224,6],[8225,7],[8226,21],[8230,5],[8240,9],[8249,11],[8250,27],[8364,0],[8482,25]])),j=(new Map([[0,"€"],[1,""],[2,"‚"],[3,"ƒ"],[4,"„"],[5,"…"],[6,"†"],[7,"‡"],[8,"ˆ"],[9,"‰"],[10,"Š"],[11,"‹"],[12,"Œ"],[13,""],[14,"Ž"],[15,""],[16,""],[17,"‘"],[18,"’"],[19,"“"],[20,"”"],[21,"•"],[22,"–"],[23,"—"],[24,"˜"],[25,"™"],[26,"š"],[27,"›"],[28,"œ"],[29,""],[30,"ž"],[31,"Ÿ"],[32," "],[33,"¡"],[34,"¢"],[35,"£"],[36,"¤"],[37,"¥"],[38,"¦"],[39,"§"],[40,"¨"],[41,"©"],[42,"ª"],[43,"«"],[44,"¬"],[45,"­"],[46,"®"],[47,"¯"],[48,"°"],[49,"±"],[50,"²"],[51,"³"],[52,"´"],[53,"µ"],[54,"¶"],[55,"·"],[56,"¸"],[57,"¹"],[58,"º"],[59,"»"],[60,"¼"],[61,"½"],[62,"¾"],[63,"¿"],[64,"À"],[65,"Á"],[66,"Â"],[67,"Ã"],[68,"Ä"],[69,"Å"],[70,"Æ"],[71,"Ç"],[72,"È"],[73,"É"],[74,"Ê"],[75,"Ë"],[76,"Ì"],[77,"Í"],[78,"Î"],[79,"Ï"],[80,"Ð"],[81,"Ñ"],[82,"Ò"],[83,"Ó"],[84,"Ô"],[85,"Õ"],[86,"Ö"],[87,"×"],[88,"Ø"],[89,"Ù"],[90,"Ú"],[91,"Û"],[92,"Ü"],[93,"Ý"],[94,"Þ"],[95,"ß"],[96,"à"],[97,"á"],[98,"â"],[99,"ã"],[100,"ä"],[101,"å"],[102,"æ"],[103,"ç"],[104,"è"],[105,"é"],[106,"ê"],[107,"ë"],[108,"ì"],[109,"í"],[110,"î"],[111,"ï"],[112,"ð"],[113,"ñ"],[114,"ò"],[115,"ó"],[116,"ô"],[117,"õ"],[118,"ö"],[119,"÷"],[120,"ø"],[121,"ù"],[122,"ú"],[123,"û"],[124,"ü"],[125,"ý"],[126,"þ"],[127,"ÿ"]]),t=>{if("replacement"===t)return 65533;throw new Error});function F(t){return F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},F(t)}function M(){M=function(){return e};var t,e={},a=Object.prototype,n=a.hasOwnProperty,o=Object.defineProperty||function(t,e,a){t[e]=a.value},r="function"==typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",s=r.asyncIterator||"@@asyncIterator",c=r.toStringTag||"@@toStringTag";function l(t,e,a){return Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,a){return t[e]=a}}function u(t,e,a,n){var r=e&&e.prototype instanceof v?e:v,i=Object.create(r.prototype),s=new k(n||[]);return o(i,"_invoke",{value:T(t,a,s)}),i}function p(t,e,a){try{return{type:"normal",arg:t.call(e,a)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var d="suspendedStart",f="suspendedYield",h="executing",g="completed",m={};function v(){}function y(){}function b(){}var w={};l(w,i,(function(){return this}));var x=Object.getPrototypeOf,D=x&&x(x(_([])));D&&D!==a&&n.call(D,i)&&(w=D);var C=b.prototype=v.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function I(t,e){function a(o,r,i,s){var c=p(t[o],t,r);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==F(u)&&n.call(u,"__await")?e.resolve(u.__await).then((function(t){a("next",t,i,s)}),(function(t){a("throw",t,i,s)})):e.resolve(u).then((function(t){l.value=t,i(l)}),(function(t){return a("throw",t,i,s)}))}s(c.arg)}var r;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){a(t,n,e,o)}))}return r=r?r.then(o,o):o()}})}function T(e,a,n){var o=d;return function(r,i){if(o===h)throw new Error("Generator is already running");if(o===g){if("throw"===r)throw i;return{value:t,done:!0}}for(n.method=r,n.arg=i;;){var s=n.delegate;if(s){var c=S(s,n);if(c){if(c===m)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=g,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=h;var l=p(e,a,n);if("normal"===l.type){if(o=n.done?g:f,l.arg===m)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(o=g,n.method="throw",n.arg=l.arg)}}}function S(e,a){var n=a.method,o=e.iterator[n];if(o===t)return a.delegate=null,"throw"===n&&e.iterator.return&&(a.method="return",a.arg=t,S(e,a),"throw"===a.method)||"return"!==n&&(a.method="throw",a.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var r=p(o,e.iterator,a.arg);if("throw"===r.type)return a.method="throw",a.arg=r.arg,a.delegate=null,m;var i=r.arg;return i?i.done?(a[e.resultName]=i.value,a.next=e.nextLoc,"return"!==a.method&&(a.method="next",a.arg=t),a.delegate=null,m):i:(a.method="throw",a.arg=new TypeError("iterator result is not an object"),a.delegate=null,m)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function $(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function k(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function _(e){if(e||""===e){var a=e[i];if(a)return a.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,r=function a(){for(;++o<e.length;)if(n.call(e,o))return a.value=e[o],a.done=!1,a;return a.value=t,a.done=!0,a};return r.next=r}}throw new TypeError(F(e)+" is not iterable")}return y.prototype=b,o(C,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:y,configurable:!0}),y.displayName=l(b,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,l(t,c,"GeneratorFunction")),t.prototype=Object.create(C),t},e.awrap=function(t){return{__await:t}},E(I.prototype),l(I.prototype,s,(function(){return this})),e.AsyncIterator=I,e.async=function(t,a,n,o,r){void 0===r&&(r=Promise);var i=new I(u(t,a,n,o),r);return e.isGeneratorFunction(a)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},E(C),l(C,c,"Generator"),l(C,i,(function(){return this})),l(C,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),a=[];for(var n in e)a.push(n);return a.reverse(),function t(){for(;a.length;){var n=a.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=_,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach($),!e)for(var a in this)"t"===a.charAt(0)&&n.call(this,a)&&!isNaN(+a.slice(1))&&(this[a]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var a=this;function o(n,o){return s.type="throw",s.arg=e,a.next=n,o&&(a.method="next",a.arg=t),!!o}for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r],s=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),l=n.call(i,"finallyLoc");if(c&&l){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(t,e){for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var r=o;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var i=r?r.completion:{};return i.type=t,i.arg=e,r?(this.method="next",this.next=r.finallyLoc,m):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var a=this.tryEntries[e];if(a.finallyLoc===t)return this.complete(a.completion,a.afterLoc),$(a),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var a=this.tryEntries[e];if(a.tryLoc===t){var n=a.completion;if("throw"===n.type){var o=n.arg;$(a)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,a,n){return this.delegate={iterator:_(e),resultName:a,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}function V(t,e,a,n,o,r,i){try{var s=t[r](i),c=s.value}catch(t){return void a(t)}s.done?e(c):Promise.resolve(c).then(n,o)}function G(t){return function(){var e=this,a=arguments;return new Promise((function(n,o){var r=t.apply(e,a);function i(t){V(r,n,o,i,s,"next",t)}function s(t){V(r,n,o,i,s,"throw",t)}i(void 0)}))}}function B(t){t=((t,e)=>{let a;e&&e.mode&&(a=e.mode.toLowerCase()),"fatal"!==a&&"replacement"!==a&&(a="fatal");const n=t.length,o=new Uint16Array(n);for(let e=0;e<n;e++){const n=t.charCodeAt(e);if(0<=n&&n<=127)o[e]=n;else if(L.has(n)){const t=L.get(n);o[e]=t+128}else o[e]=j(a)}return o})(t,{mode:"replacement"});var e=new Uint8Array([129,141,143,144,157]),a=new Uint8Array(e.length+t.length);return a.set(e,0),a.set(t,e.length),a}var U,J,K=function(){var t=G(M().mark((function t(e,a){var n,o,r,i,s,c,l,u;return M().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=$("#readProgressBar .progress-bar"),o=new JSZip,t.next=4,o.loadAsync(e);case 4:return r=new TextDecoder("windows-1252"),i=[],s=0,c=0,o.forEach((function(t,e){c++})),l={},u=["goldequip","platinaequip"],(u=Object.keys(C)).push("buysell"),u.push("goods"),o.forEach((function(t,e){if(t.endsWith(".txt")){if(0===u.filter((function(e){return-1!==t.indexOf(e)})).length)return void s++;var a=e.async("arraybuffer").then((function(e){var a=r.decode(e);if(-1===t.indexOf("goods")&&-1===t.indexOf("buysell")&&-1===a.indexOf("ItemGenre"))return s++,!0;l[t]=a.split(/\r?\n/).filter(Boolean),s++;var o=Math.floor(100*s/c);n.css("width",o+"%").text(o+"%").closest("div").attr("aria-valuenow",o)}));i.push(a)}else s++})),t.next=16,Promise.all(i);case 16:n.css("width","0").text(""),a(l);case 18:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}(),q={patchGoodsTxt:function(t){var e=0;if($.each(t,(function(t,a){a.length>20?e++:e--})),e<t.length/2){var a=[];return $.each(t.slice(),(function(t,e){var n=Array(27).fill("");n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[6]=e[5],n[7]=e[6],n[8]=e[7],n[9]=e[8],n[10]=e[9],n[25]=e[10],n[12]=e[11],n[13]=e[12],n[14]=e[13],n[22]=e[14],n[23]=e[15],n[26]=e[16],a.push(n)})),b.data.goodsData=a,!0}return!1},undoPatchGoodsTxt:function(t){var e=[];return $.each(t,(function(t,a){var n=Array(17).fill("");n[0]=a[0],n[1]=a[1],n[2]=a[2],n[3]=a[3],n[4]=a[4],n[5]=a[6],n[6]=a[7],n[7]=a[8],n[8]=a[9],n[9]=a[10],n[10]=a[25],n[11]=a[12],n[12]=a[13],n[13]=a[14],n[14]=a[22],n[15]=a[23],n[16]=a[26],e.push(n)})),e},patchBuySellTxt:function(t){var e=0;return $.each(t,(function(t,a){"string"==typeof a[0]?e++:e--})),e<t.length/2&&(t=t.map((function(t,e){return 0===e?t.unshift("Name"):t.unshift(""),t})),b.data.buysellData=t,!0)},undoPatchBuySellTxt:function(t){return t.slice().map((function(t){return t.shift(),t}))}};const H={fileManager:{readZipFileFromURL:(J=G(M().mark((function t(e,a){var n;return M().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(e);case 2:if((n=t.sent).ok){t.next=5;break}throw new Error("Failed to fetch the ZIP file (HTTP status: ".concat(n.status,")."));case 5:K(n.arrayBuffer(),a);case 6:case"end":return t.stop()}}),t)}))),function(t,e){return J.apply(this,arguments)}),readZipFileFromLocal:(U=G(M().mark((function t(e,a){var n;return M().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(n=new FileReader).onload=function(t){var e=t.target.result;K(e,a)},n.readAsArrayBuffer(e);case 3:case"end":return t.stop()}}),t)}))),function(t,e){return U.apply(this,arguments)}),save2File:function(t,e){var a;a=new Blob([B(e)],{type:"text/csv;charset=windows-1252"});var n=URL.createObjectURL(a),o=document.createElement("a");o.href=n,o.download=t,o.click(),URL.revokeObjectURL(n)}},helpers:R,vConverter:q};var Y=a(507),Z={};Z.styleTagTransform=d(),Z.setAttributes=c(),Z.insert=i().bind(null,"head"),Z.domAPI=o(),Z.insertStyleElement=u(),e()(Y.Z,Z),Y.Z&&Y.Z.locals&&Y.Z.locals;var z,Q,X={6:"Tiền",7:"P Duyên",8:"Xu",9:"Điểm TK",10:"Vinh Dự",11:"Cống hiến",12:"Danh vọng",13:"Điểm CT"},W=H.helpers.u2t("(Chưa có tên)"),tt=function(t,e){var a=e[26]?""+e[26]:"",n=[e[0],e[1],e[2]||0,e[3]||0,e[4]||0].join("_");return b.data.allItems&&b.data.allItems[n]&&(a=b.data.allItems[n].name),""===$.trim(a)&&(a=W+" "+n),{name:a,index:t,data:e,code:n,type:b.data.allItems&&b.data.allItems[n]?b.data.allItems[n].__type:"others"}},et=function(t){var e=t.isFirstRow?t.name:H.helpers.t2u(t.name),a="<li class='dataRow isEditing ".concat(at[t.index]?"isChanged":"","' forID='").concat(t.index,"'>");return a+='\n\t\n\t\t<span class="colChose" title="Thêm vào buysell.txt">\n\t\t\t'.concat(t.isFirstRow?"Thêm":'<button class=\'btn btn-primary btn-sm add2BuySell\' data-bs-container="body" data-bs-toggle="popover" data-bs-placement="top" data-bs-content="Đã thêm vào buysell.txt">+</button>','\n\t\t</span>\n\t\t\n        <span class="colID" title=\'').concat(t.index," (").concat(t.code,")'>\n            ").concat(t.index,'\n        </span>\n        <span class="colName"> \n            ')+(t.isFirstRow?e:'\n            <span class="colEdit">\n                <select class="searchItem" forID=\''.concat(t.index,"'>\n                    <option value=\"").concat(t.code,'">').concat(e,"</option>                \n                </select>\n            </span>\n            "))+"\n        </span>\n\t\t\n\n    ",t.shopCounter&&(a+='\n\n        <span class="colShopCounter" title=\''.concat(t.isFirstRow?"":t.shopCounter.join(","),"'>\n            ").concat(t.isFirstRow?"SD":t.shopCounter.length,"\n        </span>\n        ")),a+='\n\n        <span class="colShopCounter" title=\''.concat(t.isFirstRow?"Ngũ Hành":t.kind,"'>\n            ").concat(t.isFirstRow?"NH":t.data[3],'\n        </span>\n\t\t\n        <span class="colShopCounter" title=\'').concat(t.isFirstRow?"Cấp":t.level,"'>\n            ").concat(t.isFirstRow?"Cấp":t.data[4],"\n        </span>\n        "),$.each(X,(function(e,n){a+='                \n        <span class="colData '.concat((t.isFirstRow,""),'" forColumn="').concat(e,'">\n        ').concat(t.isFirstRow?X[e]:'\n            <span class="colDisplay">'.concat(t.isFirstRow?X[e]:t.data[e],'</span>\n            <input class="colEdit" type="number" value="').concat(t.data[e],'"/>\n            '),"\n        </span>")})),a+='<span class="controllerTool">\n        '.concat(t.isFirstRow?"":"<button class='btn btn-secondary btn-sm cancelEditGood'>Phục Hồi</button> <button class='btn btn-danger btn-sm deleteGood'>Xóa</button>","\n    </span>"),a+="</li>"},at={},nt=!1,ot={show:function(t,e){if(t&&(z=t),e&&(Q=e),function(t){if(!nt){nt=!0,$("#goodsEditorPagination").on("click",".page-link",(function(e){e.preventDefault(),e.stopPropagation(),ot.show(t,$(this).attr("forPage"))}));var e=_.debounce((function(){ot.show(!1,1)}),1e3);$("#filterGoodByName").keyup(e),t.on("click",".controllerTool .cancelEditGood",(function(t){t.preventDefault(),t.stopPropagation();var e=$(this).closest(".dataRow").attr("forID");b.data.goodsData[e]=JSON.parse(JSON.stringify(at[e])),delete at[e],ot.show()})),t.on("click",".controllerTool .deleteGood",(function(e){e.preventDefault(),e.stopPropagation();var a=$(this).closest(".dataRow").attr("forID");b.data.goodsData.splice(a,1),b.data.buysellData.forEach((function(t,e){if(0==e)return!0;if(t.length<=1)return!0;var n=!1;(t=t.filter((function(t,e){return!(e>0&&t===a&&(n=!0,1))}))).forEach((function(e,o){o>0&&e>a&&(t[o]=e-1,n=!0)})),n&&(b.data.buysellData[e]=t)})),ot.show(t,Q),ht.show()}));var a=$("#addNewItemToGoodInp");a.select2($.extend({},window.llGlobal,{ajax:{delay:500,cache:!0,url:function(t){return""},processResults:function(t,e){var a=e.term,n=[];return""!==a&&(a=H.helpers.u2t(a).toLowerCase(),$.each(b.data.allItemsKey,(function(t,e){var o=b.data.allItems[e];-1!==b.getSearchToken(e,o).indexOf(a)&&n.push({text:H.helpers.t2u(o.name)+" ("+e.replace(/_/g," ")+" "+o.__type+")",id:e})}))),{results:n}}}})),a.on("select2:select",(function(t){var e=t.params.data,a=Array(b.data.goodsData[b.data.goodsData.length-1].length).fill(""),n=JSON.parse(JSON.stringify(b.data.allItems[e.id]));a[26]=n.name,a[0]=n.genre,a[1]=n.type,a[2]=n.spec,a[3]=n.kind,a[4]=n.level,b.data.goodsData.push(a),ot.show(),llEvents.trigger("buysell.update")})),t.on("blur",".colEdit[type='number']",(function(t){var e=parseInt($(this).closest(".colData").attr("forColumn"),10),a=parseInt($(this).val(),10),n=parseInt($(this).closest(".dataRow").attr("forID"),10);b.data.goodsData[n][e]=a})),llEvents.on("goods.changed",_.debounce((function(){ot.show()}),1e3)),$("#buysellSelection").change((function(){var t=$(this).val(),e=$(this).find('option[value="'+t+'"]');$(".add2BuySell").attr("data-bs-content","Đã thêm vào "+e.text()),$(".add2BuySell").closest(".colChose").attr("title","Thêm vào "+e.text())})),t.on("click",".add2BuySell",(function(){var t=$(this).closest(".dataRow"),e=parseInt(t.attr("forID"),10),a=$("#buysellSelection").val();if(b.data.buysellData[a]){var n=!1;$.each(b.data.buysellData[a],(function(t,o){if(t>0&&(""==o||!o))return b.data.buysellData[a][t]=e,n=!0,!1})),n||b.data.buysellData[a].push(e)}t.addClass("flash-row"),llEvents.trigger("buysell.update")}))}}(z),b.data.goodsData){var a=JSON.parse(JSON.stringify(b.data.goodsData)),n=b.data.goodsData.length,o=a.shift();a.reverse();var r=[];a.forEach((function(t,e){var a=n-e-1,o=tt(a,t);b.data.goodsData[a][26]=o.name,r.push(o)}));var i=$("#filterGoodByName").val(),s=[];if(""!==i&&(i=H.helpers.u2t(i),$.each(r,(function(t,e){e.name&&-1!==e.name.toLowerCase().indexOf(i.toLowerCase())&&s.push(e)})),r=s),z.empty(),!r||0===r.length)return!0;var c=Math.ceil(r.length/100);Q||(Q=1);for(var l=$("#goodsEditorPagination"),u=$('<ul class="pagination"></ul>'),p=1;p<=c;p++)u.append('<li class="page-item '+(p==Q?"active":"")+'" ><a class="page-link" href="#" forPage="'+p+'">'+(c-p+1)+"</a></li>");l.empty().append(u);var d=100*(Q-1),f=Math.min(d+100,r.length),h=r.slice(d,f),g="<ul id='goodsTable' class='baseTableShop'>";g+=et({name:"Tên",index:"ID",data:o,isFirstRow:!0,id:"ID",shopCounter:[]}),h.forEach((function(t,e){var a=JSON.parse(JSON.stringify(t));a.shopCounter=[],$.each(b.data.buysellData,(function(e,n){n.indexOf(t.index)>0&&a.shopCounter.push(e)})),g+=et(a)})),g+="</ul>",z.html(g),z.find(".searchItem").select2($.extend({},window.llGlobal,{ajax:{delay:50,cache:!0,url:function(t){return""},processResults:function(t,e){var a=e.term,n=[];return""!==a&&$.each(b.data.allItemsKey,(function(t,e){var o=b.data.allItems[e];-1!==(e.replace(/_/g," ")+o.name+o.spr).toLowerCase().indexOf(a.toLowerCase())&&n.push({text:o.name+" ("+e.replace(/_/g," ")+" "+o.__type+")",id:e})})),{results:n}}}})),z.find(".searchItem").on("select2:select",(function(t){var e=t.params.data;!function(t,e){void 0===at[t]&&(at[t]=JSON.parse(JSON.stringify(b.data.goodsData[t])));var a=b.data.allItems[e];b.data.goodsData[t][26]=a.name,b.data.goodsData[t][0]=a.genre,b.data.goodsData[t][1]=a.type,b.data.goodsData[t][2]=a.spec,b.data.goodsData[t][3]=a.kind,b.data.goodsData[t][4]=a.level,ot.show(),llEvents.trigger("buysell.update")}($(this).attr("forID"),e.id)}))}}};const rt=ot;var it,st,ct,lt,ut=function(t){if(b.data.buysellData[st]){var e=!1;$.each(b.data.buysellData[st],(function(a,n){if(a>0&&(""==n||!n))return b.data.buysellData[st][a]=t,e=!0,!1})),e||b.data.buysellData[st].push(t)}},pt=!1,dt=function(){ct.empty(),lt.empty();var t="";b.data.buysellData&&b.data.buysellData.forEach((function(e,a){if(0==a)return!0;if(e.length<=1)return!0;var n=H.helpers.t2u(""+e[0]);ct.append('<option value="'.concat(a,'">CH ').concat(a," - ").concat(n,"</option>")),lt.append('<option value="'.concat(a,'">CH ').concat(a," - ").concat(n,"</option>")),t=a})),ct.val(b.isDEV?140:t).change(),lt.val(b.isDEV?140:t).change()},ft={init:function(t){t&&(it=t),ct=$("#shopSelect"),lt=$("#buysellSelection"),function(){if(!pt){pt=!0,llEvents.on("buysell.update",_.debounce((function(){ft.show()}),1e3)),ct.change((function(){var t=$(this).val(),e=$(this).find('option[value="'+t+'"]');$("#selectedShopName").text(e.text()),ft.show(t)})),$("#createNewShop").click((function(){var t=$("#createNewShopInp").val();b.data.buysellData.push([t]);var e=b.data.buysellData.length-1;ct.append('<option value="'.concat(e,'">Shop ').concat(e," - ").concat(t,"</option>")),ct.val(e).change(),lt.append('<option value="'.concat(e,'">Shop ').concat(e," - ").concat(t,"</option>")),lt.val(e).change()})),$("#deleteShop").click((function(){b.data.buysellData.splice(st,1),st=!1,dt()})),it.on("click",".deleteGood",(function(t){t.preventDefault(),t.stopPropagation();var e=parseInt($(this).closest(".dataRow").attr("forID"),10),a=b.data.buysellData[st],n=e;a.splice(n+1,1),b.data.buysellData[st]=a,ft.show(st)}));var t=$("#addNewGoodToShopInp");t.select2($.extend({},window.llGlobal,{ajax:{delay:500,cache:!0,url:function(t){return""},processResults:function(t,e){var a=e.term,n=[];return""!==a&&(a=H.helpers.u2t(a),$.each(b.data.goodsData,(function(t,e){if(0===t)return!0;var o=e.slice();-1!==(o.join(" ")+t).toLowerCase().indexOf(a.toLowerCase())&&n.push({text:H.helpers.t2u(o[26])+" ("+t+") ",id:t})}))),{results:n}}}})),t.on("select2:select",(function(t){var e=t.params.data;ut(e.id),ft.show()})),$("#addNewGoodToShop").click((function(){var e=t.val();ut(e),ft.show()}))}}(),dt()},show:function(t){if(it.empty(),t&&(st=t),""===t)return!0;if(st=parseInt(st),b.data.buysellData&&b.data.buysellData[st]){var e=b.data.buysellData[st].slice();e.shift(),e=e.filter((function(t){return t&&""!=t}));var a="<ul id='buysellTable' class='baseTableShop'>";a+=et({name:"Tên",index:"ID",data:[],isFirstRow:!0,id:"ID"}),e.forEach((function(t,e){var n=tt(e,b.data.goodsData[t]);if(!n)return!0;b.data.goodsData[t][26]=n.name;var o=JSON.parse(JSON.stringify(n));o.name=o.name+" ("+t+")",a+=et(o)})),a+="</ul>",it.html(a);var n=it.find("ul");n.sortable({update:function(t,e){var a;a=[],n.find("li").each((function(){var t=$(this).attr("forId");if("ID"===t)return a.push(b.data.buysellData[st][0]),!0;a.push(b.data.buysellData[st][parseInt(t,10)+1])})),b.data.buysellData[st]=a,ft.show()}}),it.find(".searchItem").select2($.extend({},llGlobal,{ajax:{delay:500,cache:!0,url:function(t){return""},processResults:function(t,e){var a=e.term,n=[];return""!==a&&(a=H.helpers.u2t(a),$.each(b.data.goodsData,(function(t,e){if(0===t)return!0;var o=e.slice();-1!==o.join(" ").toLowerCase().indexOf(a.toLowerCase())&&n.push({text:H.helpers.t2u(o[26])+" ("+t+") ",id:t})}))),{results:n}}}})),it.find(".searchItem").on("select2:select",(function(t){var e,a,n=t.params.data;e=$(this).attr("forID"),a=n.id,e=parseInt(e,10),a=parseInt(a,10),b.data.buysellData[st][e+1]=a,b.data.buysellData[st]=b.data.buysellData[st].map((function(t,e){if(0==e)return t;try{return(t=parseInt(t,10))>0?t:""}catch(t){return""}})),ft.show()}))}}};const ht=ft;var gt,mt=1,vt=["","Tên vật phẩm","Genre","Type","Spec","Hình","Tác dụng trong hành trang","Chiều ngang hình","Chiều dọc hình","Mô tả","HDSD","Giá bán vào shop","?","SL nhỏ trong hành trang","LUA script","Hiệu ứng","Có thể vứt","Thông báo","?","Có thể bỏ vào phím tắt","?","SL Xếp chồng","Level nv sử dụng"],yt=function(t){return[t[1],t[2],t[3]||0,t[9]||0,t[11]||0].join("_")},bt=function(t,e){var a=t.shift(),n=yt(t),o="<li class='dataRow isEditing ".concat(-1===e?"firstRow":"","' forID='").concat(a,"' forCode='").concat(n,"'>");return o+=' \n        <span class="colChose" title="Thêm vào danh sách vật phẩm bán (goods.txt)">\n            '.concat(-1===e?"":'<button class=\'btn btn-primary btn-sm add2Goods\' data-bs-container="body" data-bs-toggle="popover" data-bs-placement="top" data-bs-content="Đã thêm vào ds vật phẩm bán (goods.txt)">+</button>','\n        </span>\n        <span class="rowData" title="').concat(n,'">').concat(a,"</span>\n    "),$.each(t,(function(t,a){if(t>21)return!1;if(-1===e){var n=String.fromCharCode(65+t)||"";o+='<span class="rowData" forCol="'.concat(t,'" title="').concat(vt[t],'">\n                \n                ').concat(a,"<br/>\n                <b>").concat(n,"</b>\n            </span>")}else{if(-1!==[1].indexOf(t))return o+='\n                <span class="rowData '.concat(-1!==[0,4,8,13].indexOf(t)?"isText":"isNumber",'" forCol="').concat(t,'">\n                    ').concat(a,"\n                </span>"),!0;-1!==[0,4,8].indexOf(t)&&(a=he.escape(H.helpers.t2u(a))),o+='\n            <span class="rowData '.concat(-1!==[0,4,8,13].indexOf(t)?"isText":"isNumber",'" forCol="').concat(t,'" title="').concat(vt[t],'">\n                <input class="form-control" type="text" forCol="').concat(t,'" value="').concat(a,'"/>\n            </span>')}})),o+='<span class="controllerTool">\n        '.concat(-1===e?"":"<button class='btn btn-secondary btn-sm cancelEditGood'>Phục Hồi</button> <button class='btn btn-danger btn-sm deleteMSItem'>Xóa</button>","\n    </span>"),o+="</li>"},wt=!1,xt={show:function(t,e){t&&(gt=t),e&&(mt=e),function(){if(!wt){wt=!0,$("#magicscriptEditorPagination").on("click",".page-link",(function(t){t.preventDefault(),t.stopPropagation(),xt.show(!1,$(this).attr("forPage"))}));var t=_.debounce((function(){xt.show(!1,1)}),1e3);$("#magicscript-tab-pane").on("keyup","#filterMagicscriptByName",t),gt.on("click",".add2Goods",(function(){var t=$(this).closest(".dataRow"),e=t.attr("forCode"),a=Array(b.data.goodsData[b.data.goodsData.length-1].length).fill(""),n=JSON.parse(JSON.stringify(b.data.allItems[e]));a[26]=n.name,a[0]=n.genre,a[1]=n.type,a[2]=n.spec,a[3]=n.kind,a[4]=n.level,t.addClass("flash-row"),b.data.goodsData.push(a),llEvents.trigger("goods.changed")})),gt.on("click",".controllerTool .deleteMSItem",(function(t){t.preventDefault(),t.stopPropagation();var e=$(this).closest(".dataRow").attr("forID"),a=$(this).closest(".dataRow").attr("forCode");delete b.searchCache[a],b.data.magicscript.splice(e,1),delete b.data.allItems[a],b.data.allItemKeysByType.magicscript=b.data.allItemKeysByType.magicscript.filter((function(t){return t!==a})),b.data.allItemsKey=b.data.allItemsKey.filter((function(t){return t!==a})),xt.show(gt,mt)})),$("#addNewMSItem").click((function(t){t.preventDefault(),t.stopPropagation();var e=JSON.parse(JSON.stringify(b.data.magicscript[b.data.magicscript.length-1].slice()));e[0]="",e[3]=e[3]?e[3]+1:0,e[4]="",e[5]="",e[8]="",e[13]="",b.data.magicscript.push(e),b.addItemToCachePool("magicscript",e),b.onCachePoolReady(),xt.show()})),gt.on("blur",".rowData input",(function(t){var e=parseInt($(this).closest(".rowData").attr("forCol"),10),a=$(this).val(),n=parseInt(a,10);isNaN(n)?-1!==[0,4,8].indexOf(e)&&(a=H.helpers.u2t(a)):a=n;var o=parseInt($(this).closest(".dataRow").attr("forID"),10),r=yt(b.data.magicscript[o]);b.data.magicscript[o][e]=a,delete b.data.allItems[r],delete b.searchCache[r],b.data.allItemKeysByType.magicscript=b.data.allItemKeysByType.magicscript.filter((function(t){return t!==r})),b.data.allItemsKey=b.data.allItemsKey.filter((function(t){return t!==r})),b.addItemToCachePool("magicscript",b.data.magicscript[o]),b.onCachePoolReady()}))}}();var a=JSON.parse(JSON.stringify(b.data.magicscript));(a=a.map((function(t,e){return t.unshift(e),t}))).shift(),a.reverse();var n=H.helpers.u2t($("#filterMagicscriptByName").val());if(""!==n&&(n=n.toLowerCase(),a=a.filter((function(t){var e=[t[2],t[3],t[4]||0,t[10]||0,t[12]||0].join("_");return-1!==b.getSearchToken(e,b.data.allItems[e]).indexOf(n)}))),gt.empty(),!a)return!0;var o=a.length,r=Math.ceil(o/100);mt>r&&(mt=r);for(var i=$("#magicscriptEditorPagination"),s=$('<ul class="pagination"></ul>'),c=1;c<=r;c++)s.append('<li class="page-item '+(c==mt?"active":"")+'" ><a class="page-link" href="#" forPage="'+c+'">'+(r-c+1)+"</a></li>");i.empty().append(s),console.log("G",s);var l=100*(mt-1),u=Math.min(l+100,a.length),p=a.slice(l,u),d="<ul id='magicscriptTable' class='baseTableShop'>";d+=bt(JSON.parse(JSON.stringify(vt)),-1),p.forEach((function(t,e){d+=bt(t,e)})),d+="</ul>",gt.empty().append($(d)),document.querySelectorAll('[data-bs-toggle="popover"]').forEach((function(t){t.hasAttribute("data-bs-popover-initialized")||(t.setAttribute("data-bs-popover-initialized","true"),new bootstrap.Popover(t),t.addEventListener("shown.bs.popover",(function(){var e=bootstrap.Popover.getInstance(t);setTimeout((function(){e.hide()}),2e3)})))}))}};const Dt=xt;var Ct={init:function(t,e){$("#downloadAllv6").click((function(){H.fileManager.save2File("goods.txt",H.helpers.arrayToCSV(H.vConverter.undoPatchGoodsTxt(b.data.goodsData))),H.fileManager.save2File("buysell.txt",H.helpers.arrayToCSV(H.vConverter.undoPatchBuySellTxt(b.data.buysellData)))})),$("#downloadAllv8").click((function(){H.fileManager.save2File("goods.txt",H.helpers.arrayToCSV(b.data.goodsData)),H.fileManager.save2File("buysell.txt",H.helpers.arrayToCSV(b.data.buysellData))})),$("#downloadMagicScript").click((function(){H.fileManager.save2File("magicscript.txt",H.helpers.arrayToCSV(b.data.magicscript)+"\r\n")})),$("#backHome").click((function(){b.data={},$("#zip004Input").val(""),$("body").removeClass("loadedData")}));var a=document.getElementById("uploadButton"),n=new bootstrap.Popover(a,{placement:"right",content:"Ủa gì dợ ? File đâu?",trigger:"manual"});$("#uploadButton").click((function(){var a=document.getElementById("zip004Input").files[0];a?H.fileManager.readZipFileFromLocal(a,(function(a){t(a,e)})):(n.show(),setTimeout((function(){n.hide()}),5e3))})),$("#huongdan-tab-pane a[dTarget]").click((function(t){t.preventDefault(),t.stopPropagation();var e=$(this).attr("dTarget");$(e).click()})),document.getElementById("zip004Input").addEventListener("change",(function(t){_.defer((function(){$("#uploadButton").click()}),1)}))},renderBuySellDropdown:function(){ht.init($("#buysellEditor"))},renderItemsViewer:function(){O.show($("#itemViewer"),1)},renderGoodsEditor:function(){rt.show($("#goodsEditor"))},renderMagicScriptEditor:function(){Dt.show($("#magicscriptEditor"))}};const Et=Ct;function It(t,e){var a=(t.match(/\//g)||[]).length,n=(e.match(/\//g)||[]).length;return a<n?-1:a>n?1:t.localeCompare(e)}var Tt=function(t,e){b.data.allItems={},b.data.allItemKeysByType={};var a=Object.keys(t);a.sort(It);for(var n=0;n<a.length;n++){var o=a[n],r=t[o],i=H.helpers.getFileName(o).replace(".txt","");if("platinaequip"==i&&(i="goldequip"),"goods"!==i)if("buysell"!==i){"magicscript"===i&&(b.data.magicscript=r.map(H.helpers.parseCSVRow));for(var s=0;s<r.length;s++){var c=r[s];if(0==s&&c&&(-1===c.toLowerCase().indexOf("itemgenre")||-1===c.toLowerCase().indexOf("detailtype")))break;var l=H.helpers.parseCSVRow(c);0!=s&&b.addItemToCachePool(i,l,s)}}else b.data.buysellData=r.map(H.helpers.parseCSVRow),H.vConverter.patchBuySellTxt(b.data.buysellData)&&(b.v6=!0);else b.data.goodsData=r.map(H.helpers.parseCSVRow),H.vConverter.patchGoodsTxt(b.data.goodsData)&&(b.v6=!0)}if(b.onCachePoolReady(),!b.data.goodsData||!b.data.goodsData.length)return!0;e()};$(document).ready((function(){var t=function(){Et.renderItemsViewer(),Et.renderGoodsEditor(),Et.renderBuySellDropdown(),Et.renderMagicScriptEditor(),b.isDEV?$("#magicscript-tab").click():$("#goods-txt-tab").click(),$("body").addClass("loadedData")};Et.init(Tt,t),b.isDEV&&H.fileManager.readZipFileFromURL("assets/files/server1.zip",(function(e){Tt(e,t)}))}))})()})();