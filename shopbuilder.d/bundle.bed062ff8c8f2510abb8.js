/*! For license information please see bundle.bed062ff8c8f2510abb8.js.LICENSE.txt */
(()=>{"use strict";var t={507:(t,e,n)=>{n.d(e,{Z:()=>c});var a=n(81),r=n.n(a),o=n(645),i=n.n(o)()(r());i.push([t.id,'.nav-pagination{text-align:left;width:auto;display:block;text-align:center;margin:50px auto;width:700px}.nav-pagination ul.pagination{display:block}.nav-pagination ul.pagination li{border-radius:0px !important;display:inline-block}.controllerTool .cancelEditGood{display:none}.isChanged .controllerTool .cancelEditGood{display:inline-block}.baseTableShop{list-style-type:none;padding:0;margin:0;margin-top:20px}.baseTableShop li{display:block;padding-bottom:5px;white-space:nowrap}.baseTableShop li>span{vertical-align:middle;display:inline-block;white-space:nowrap;text-overflow:ellipsis}.baseTableShop .colName{min-width:300px;font-weight:bold;margin-right:13px}.baseTableShop .colName .colEdit{min-width:300px !important}.baseTableShop .colID{min-width:45px}.baseTableShop .colData{min-width:35px;margin-right:5px}.baseTableShop .colEdit{display:none;min-width:30px}.baseTableShop .isEditing .colEdit{display:block}.baseTableShop .isEditing .colDisplay{display:none}.baseTableShop .dataRow:hover{background-color:#ececec}.baseTableShop .colShopCounter{min-width:30px}#goodsTable .colData,#buysellTable .colData{min-width:80px;max-width:80px}#goodsTable .colEdit,#buysellTable .colEdit{min-width:80px;max-width:80px}#buysellTable .colData .colEdit{display:none !important}#buysellTable .colData .colDisplay{display:inline-block !important}#itemViewer .colSpr,#itemViewer .colScript{min-width:300px !important}#itemViewer .colType{min-width:250px !important}#itemViewer .colID:hover{cursor:pointer}.select2-container--default .select2-selection--single{font-weight:normal}.buysellEditorContainer{border:1px solid #ececec;overflow:auto}.buysellEditorContainer .colChose{display:none !important}#buysell-addGoods{margin-top:20px}.addMoreShop{margin-top:20px;width:600px}.flash-row{background-color:#cfe2ff}.dataRow{transition:background-color 500ms ease}.downloadMagicScriptContainer{text-align:center;margin:20px}#magicscriptTable{display:table}#magicscriptTable>li{display:table-row}#magicscriptTable>li>span{display:table-cell;padding:3px}#magicscriptTable .firstRow span{vertical-align:bottom;white-space:normal;text-align:left}#magicscriptTable .rowData[forCol="9"],#magicscriptTable .rowData[forCol="11"],#magicscriptTable .rowData[forCol="16"],#magicscriptTable .rowData[forCol="17"],#magicscriptTable .rowData[forCol="19"]{display:none}#magicscriptTable .isNumber .form-control{width:35px}#magicscriptTable .isNumber .form-control[forCol=\'3\']{width:70px}#magicscriptTable .isText .form-control{width:350px}#magicscriptTable .rowData.isNumber[forCol="5"] .form-control{width:70px}.formQuickEdit{white-space:nowrap}.formQuickEdit div{margin-right:20px;display:inline-block;vertical-align:middle}.popover{--bs-popover-max-width: 500px}.cacheFoundContainer{display:none}.cacheFoundContainer.isVisible{display:block}\n',""]);const c=i},800:(t,e,n)=>{n.d(e,{Z:()=>c});var a=n(81),r=n.n(a),o=n(645),i=n.n(o)()(r());i.push([t.id,".pageMain{padding:20px}.controllerContainer{background-color:#ececec;padding:20px;margin:20px 0px}.dataContainer{padding:20px}#readProgressBar{margin-top:20px}.exportSection{text-align:center;margin-top:20px}#page2{display:none}body.loadedData #page1{display:none}body.loadedData #page2{display:block}footer{font-weight:normal;color:#bbb}.pageMain{margin:auto}#uploadButton{display:none}\n",""]);const c=i},645:t=>{t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",a=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),a&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),a&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,a,r,o){"string"==typeof t&&(t=[[null,t,void 0]]);var i={};if(a)for(var c=0;c<this.length;c++){var s=this[c][0];null!=s&&(i[s]=!0)}for(var l=0;l<t.length;l++){var u=[].concat(t[l]);a&&i[u[0]]||(void 0!==o&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=o),n&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=n):u[2]=n),r&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=r):u[4]="".concat(r)),e.push(u))}},e}},81:t=>{t.exports=function(t){return t[1]}},379:t=>{var e=[];function n(t){for(var n=-1,a=0;a<e.length;a++)if(e[a].identifier===t){n=a;break}return n}function a(t,a){for(var o={},i=[],c=0;c<t.length;c++){var s=t[c],l=a.base?s[0]+a.base:s[0],u=o[l]||0,p="".concat(l," ").concat(u);o[l]=u+1;var d=n(p),f={css:s[1],media:s[2],sourceMap:s[3],supports:s[4],layer:s[5]};if(-1!==d)e[d].references++,e[d].updater(f);else{var h=r(f,a);a.byIndex=c,e.splice(c,0,{identifier:p,updater:h,references:1})}i.push(p)}return i}function r(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,r){var o=a(t=t||[],r=r||{});return function(t){t=t||[];for(var i=0;i<o.length;i++){var c=n(o[i]);e[c].references--}for(var s=a(t,r),l=0;l<o.length;l++){var u=n(o[l]);0===e[u].references&&(e[u].updater(),e.splice(u,1))}o=s}}},569:t=>{var e={};t.exports=function(t,n){var a=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(n)}},216:t=>{t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},565:(t,e,n)=>{t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},795:t=>{t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var a="";n.supports&&(a+="@supports (".concat(n.supports,") {")),n.media&&(a+="@media ".concat(n.media," {"));var r=void 0!==n.layer;r&&(a+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),a+=n.css,r&&(a+="}"),n.media&&(a+="}"),n.supports&&(a+="}");var o=n.sourceMap;o&&"undefined"!=typeof btoa&&(a+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),e.styleTagTransform(a,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},589:t=>{t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},702:function(t,e,n){var a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.VietnameseConversion=void 0;var r=a(n(926)),o=function(){function t(t,e){if(this._charsets=r.default,!this.isValidCharset(e))throw Error("Charset is not valid");this._text=t,this._chartset=e.toUpperCase()}return t.prototype.isValidCharset=function(t){return Object.keys(this._charsets).indexOf(t.toUpperCase())>-1},t.prototype.getCharsArray=function(t){return this._charsets[t]},t.prototype.toCharset=function(t){if(!this.isValidCharset(t))throw Error("Charset is not valid");if(this._chartset===t.toUpperCase())return this._text;for(var e=this.getCharsArray(this._chartset),n=this.getCharsArray(t.toUpperCase()),a=e.length,r=this._text,o=0;o<a;o++){var i=e[o],c=new RegExp(i,"g");r=r.replace(c,"::"+o+"::")}for(o=0;o<a;o++)i=n[o],c=new RegExp("::"+o+"::","g"),r=r.replace(c,i);return r},t}();e.VietnameseConversion=o,e.default=o},926:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});e.default={UNICODE:["À","Á","Â","Ã","È","É","Ê","Ì","Í","Ò","Ó","Ô","Õ","Ù","Ú","Ý","à","á","â","ã","è","é","ê","ì","í","ò","ó","ô","õ","ù","ú","ý","Ă","ă","Đ","đ","Ĩ","ĩ","Ũ","ũ","Ơ","ơ","Ư","ư","Ạ","ạ","Ả","ả","Ấ","ấ","Ầ","ầ","Ẩ","ẩ","Ẫ","ẫ","Ậ","ậ","Ắ","ắ","Ằ","ằ","Ẳ","ẳ","Ẵ","ẵ","Ặ","ặ","Ẹ","ẹ","Ẻ","ẻ","Ẽ","ẽ","Ế","ế","Ề","ề","Ể","ể","Ễ","ễ","Ệ","ệ","Ỉ","ỉ","Ị","ị","Ọ","ọ","Ỏ","ỏ","Ố","ố","Ồ","ồ","Ổ","ổ","Ỗ","ỗ","Ộ","ộ","Ớ","ớ","Ờ","ờ","Ở","ở","Ỡ","ỡ","Ợ","ợ","Ụ","ụ","Ủ","ủ","Ứ","ứ","Ừ","ừ","Ử","ử","Ữ","ữ","Ự","ự","Ỳ","ỳ","Ỵ","ỵ","Ỷ","ỷ","Ỹ","ỹ"],VNI:["AØ","AÙ","AÂ","AÕ","EØ","EÙ","EÂ","Ì","Í","OØ","OÙ","OÂ","OÕ","UØ","UÙ","YÙ","aø","aù","aâ","aõ","eø","eù","eâ","ì","í","oø","où","oâ","oõ","uø","uù","yù","AÊ","aê","Ñ","ñ","Ó","ó","UÕ","uõ","Ô","ô","Ö","ö","AÏ","aï","AÛ","aû","AÁ","aá","AÀ","aà","AÅ","aå","AÃ","aã","AÄ","aä","AÉ","aé","AÈ","aè","AÚ","aú","AÜ","aü","AË","aë","EÏ","eï","EÛ","eû","EÕ","eõ","EÁ","eá","EÀ","eà","EÅ","eå","EÃ","eã","EÄ","eä","Æ","æ","Ò","ò","OÏ","oï","OÛ","oû","OÁ","oá","OÀ","oà","OÅ","oå","OÃ","oã","OÄ","oä","ÔÙ","ôù","ÔØ","ôø","ÔÛ","ôû","ÔÕ","ôõ","ÔÏ","ôï","UÏ","uï","UÛ","uû","ÖÙ","öù","ÖØ","öø","ÖÛ","öû","ÖÕ","öõ","ÖÏ","öï","YØ","yø","Î","î","YÛ","yû","YÕ","yõ"],TCVN3:["Aµ","A¸","¢","A·","EÌ","EÐ","£","I×","IÝ","Oß","Oã","¤","Oâ","Uï","Uó","Yý","µ","¸","©","·","Ì","Ð","ª","×","Ý","ß","ã","«","â","ï","ó","ý","¡","¨","§","®","IÜ","Ü","Uò","ò","¥","¬","¦","­","A¹","¹","A¶","¶","¢Ê","Ê","¢Ç","Ç","¢È","È","¢É","É","¢Ë","Ë","¡¾","¾","¡»","»","¡¼","¼","¡½","½","¡Æ","Æ","EÑ","Ñ","EÎ","Î","EÏ","Ï","£Õ","Õ","£Ò","Ò","£Ó","Ó","£Ô","Ô","£Ö","Ö","IØ","Ø","IÞ","Þ","Oä","ä","Oá","á","¤è","è","¤å","å","¤æ","æ","¤ç","ç","¤é","é","¥í","í","¥ê","ê","¥ë","ë","¥ì","ì","¥î","î","Uô","ô","Uñ","ñ","¦ø","ø","¦õ","õ","¦ö","ö","¦÷","÷","¦ù","ù","Yú","ú","Yþ","þ","Yû","û","Yü","ü"],VIQR:["A`","A'","A^","A~","E`","E'","E^","I`","I'","O`","O'","O^","O~","U`","U'","Y'","a`","a'","a^","a~","e`","e'","e^","i`","i'","o`","o'","o^","o~","u`","u'","y'","A(","a(","DD","dd","I~","i~","U~","u~","O+","o+","U+","u+","A.","a.","A?","a?","A^'","a^'","A^`","a^`","A^?","a^?","A^~","a^~","A^.","a^.","A('","a('","A(`","a(`","A(?","a(?","A(~","a(~","A(.","a(.","E.","e.","E?","e?","E~","e~","E^'","e^'","E^`","e^`","E^?","e^?","E^~","e^~","E^.","e^.","I?","i?","I.","i.","O.","o.","O?","o?","O^'","o^'","O^`","o^`","O^?","o^?","O^~","o^~","O^.","o^.","O+'","o+'","O+`","o+`","O+?","o+?","O+~","o+~","O+.","o+.","U.","u.","U?","u?","U+'","u+'","U+`","u+`","U+?","u+?","U+~","u+~","U+.","u+.","Y`","y`","Y.","y.","Y?","y?","Y~","y~"]}},658:function(t,e,n){var a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.toVIQR=e.toTCVN3=e.toVNI=e.toUnicode=void 0;var r=a(n(702));e.toUnicode=function(t,e){return new r.default(t,e).toCharset("unicode")},e.toVNI=function(t,e){return new r.default(t,e).toCharset("vni")},e.toTCVN3=function(t,e){return new r.default(t,e).toCharset("tcvn3")},e.toVIQR=function(t,e){return new r.default(t,e).toCharset("viqr")}},384:function(t,e,n){var a=this&&this.__createBinding||(Object.create?function(t,e,n,a){void 0===a&&(a=n),Object.defineProperty(t,a,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,a){void 0===a&&(a=n),t[a]=e[n]}),r=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||a(e,t,n)},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.VietnameseConversion=void 0;var i=n(702);Object.defineProperty(e,"VietnameseConversion",{enumerable:!0,get:function(){return o(i).default}}),r(n(658),e)}},e={};function n(a){var r=e[a];if(void 0!==r)return r.exports;var o=e[a]={id:a,exports:{}};return t[a].call(o.exports,o,o.exports,n),o.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var a in e)n.o(e,a)&&!n.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.nc=void 0,(()=>{var t=n(379),e=n.n(t),a=n(795),r=n.n(a),o=n(569),i=n.n(o),c=n(565),s=n.n(c),l=n(216),u=n.n(l),p=n(589),d=n.n(p),f=n(800),h={};h.styleTagTransform=d(),h.setAttributes=s(),h.insert=i().bind(null,"head"),h.domAPI=r(),h.insertStyleElement=u(),e()(f.Z,h),f.Z&&f.Z.locals&&f.Z.locals;var g={},v={};const m={on:function(t,e,n){n?v[n]=e:(g[t]=g[t]||[],g[t].push(e))},trigger:function(t,e,n){if(n){if(!v[n])return;v[n](e)}else{if(!g[t])return;g[t].forEach((function(t){return t(e)}))}}};$(document).on("select2:open",(function(){document.querySelector(".select2-search__field").focus()})),window.llGlobal={minimumInputLength:1,width:"100%",placeholder:{id:"",placeholder:"Tìm"},language:{inputTooShort:function(){return"Gõ ít nhất 1 chữ"}}},window.llEvents=m;var y={version:"VNJX ShopBuilder 1.4",isDEV:!1,data:{},searchCache:{},getSearchToken:function(t,e){return y.searchCache[t]||(y.searchCache[t]=(t.replace(/_/g," ")+e.name+e.spr).toLowerCase()),y.searchCache[t]},addItemToCachePool:function(t,e,n){if(e.length<3)return!0;"goldequip"===t&&(e[1]=16,e[2]=n,e[3]=1);var a=e[1],r=e[2],o="questkey"==t?e[9]:e[3],i={__type:""+t,__source:"",name:""+e[0],genre:a,type:r,spec:o,kind:"huangjintupu"==t?"":"questkey"==t?0:e[9],spr:"huangjintupu"==t?"":"questkey"==t?e[3]:e[4],level:"huangjintupu"==t?"":"questkey"==t?0:e[11],script:e[13]||""},c=[i.genre,i.type,i.spec||0,""!==i.kind&&i.kind||0,""!==i.level&&i.level||0].join("_");i.code=c,y.data.allItems[c]=i}};const b=y;var w,x=1,D="all",E={horse:"Ngựa",mask:"Mặt nạ",questkey:"Vật phẩm NV",boot:"Giày",armor:"Áo",amulet:"Dây chuyền",ring:"Nhẫn",rangeweapon:"VK tầm xa",meleeweapon:"VK cận chiến",helm:"Nón",belt:"Thắt lưng",potion:"Thuốc",cuff:"Bao tay",pendant:"Ngọc bội",magicscript:"Vật phẩm",huangjintupu:"Đồ phổ",goldequip:"Đồ HK",platinaequip:"Đồ BK"},C=function(t){return E[t]?E[t]+" - "+t+" ":t},S=function(t){var e="<li class='dataRow isEditing' forID='"+t.code+"'>",n=C(t.__type),a=t.isFirstRow?t.code:[t.genre,t.type,t.spec].join(" "),r=t.isFirstRow?t.name:nt.helpers.t2u(t.name);return(e+='\n \n\n\t\t<span class="colChose" title="Thêm vào danh sách vật phẩm bán (goods.txt)">\n\t\t\t'.concat(t.isFirstRow?"":'<button class=\'btn btn-primary btn-sm add2Goods\' data-bs-container="body" data-bs-toggle="popover" data-bs-placement="top" data-bs-content="Đã thêm vào ds vật phẩm bán (goods.txt)">+</button>','\n\t\t</span>\n        <span class="colID colData" forValue=\'').concat(a,"'>\n            ").concat(a," \n            ").concat(t.kind,'\n        </span>\n        <span class="colLevel colData" title=\'').concat(t.level,"'>\n            ").concat(t.level,'\n        </span>\n        <span class="colType" title=\'').concat(n,'\'> \n            <span class="colDisplay">').concat(n," ").concat(t.isFirstRow?"":t.__source,'</span>\n            <span class="colEdit">').concat(n," ").concat(t.isFirstRow?"":t.__source,' </span>\n        </span>\n        <span class="colName" title=\'').concat(t.code,'\'> \n            <span class="colDisplay">').concat(r,'</span>\n            <span class="colEdit">').concat(r,' </span>\n        </span>\n\n        <span class="colSpr" title=\'').concat(t.spr,'\'> \n            <span class="colDisplay">').concat(t.spr,'</span>\n            <span class="colEdit">').concat(t.spr,' </span>\n        </span>\n\n        <span class="colScript" title=\'').concat("magicscript"!==n?"":t.script,'\'> \n            <span class="colDisplay">').concat("magicscript"!==n?"":t.script,'</span>\n            <span class="colEdit">').concat("magicscript"!==n?"":t.script," </span>\n        </span>\n\t\t\n    "))+"</li>"},T=!1,I={show:function(t,e){t&&(w=t),e&&(x=e),function(){if(!T){T=!0,$("#itemViewerPagination").on("click",".page-link",(function(t){t.preventDefault(),t.stopPropagation(),I.show(!1,$(this).attr("forPage"))})),$("#itemFilterSelect").on("change",(function(t){D=$(this).val(),x=1,I.show()}));var t=_.debounce((function(){I.show()}),1e3);$("#item-viewers-tab-pane").on("keyup","#filterByName",t),w.on("click",".add2Goods",(function(){var t=$(this).closest(".dataRow"),e=t.attr("forID"),n=Array(b.data.goodsData[b.data.goodsData.length-1].length).fill(""),a=JSON.parse(JSON.stringify(b.data.allItems[e]));n[26]=a.name,n[0]=a.genre,n[1]=a.type,n[2]=a.spec,n[3]=a.kind,n[4]=a.level,t.addClass("flash-row"),b.data.goodsData.push(n),llEvents.trigger("goodsData.changed")})),llEvents.on("dataCache.changed",(function(){setTimeout((function(){I.show()}),1)}))}}();var n=D&&"all"!==D?b.data.allItemKeysByType[D]:b.data.allItemsKey,a=nt.helpers.u2t($("#filterByName").val());if(""!==a){var r=[];a=a.toLowerCase(),$.each(n,(function(t,e){var n=b.data.allItems[e];-1!==b.getSearchToken(e,n).indexOf(a)&&r.push(e)})),n=r}if(!n)return!0;!function(t){var e=[];$.each(b.data.allItemKeysByType,(function(t,n){n.length>0&&e.push({label:C(t)+" (".concat(n.length,")"),value:t})})),e.sort((function(t,e){return t.label.localeCompare(e.label)}));var n=$("#itemFilterSelect");n.html('<option value="all" '+"".concat("all"===t?"selected":"")+">Tất cả</option>"),e.forEach((function(e){n.append("<option value='".concat(e.value,"' ").concat(e.value===t?"selected":"",">").concat(e.label,"</option>"))}))}(D);var o=Math.ceil(n.length/100);x>o&&(x=o);for(var i=$("#itemViewerPagination"),c=$('<ul class="pagination"></ul>'),s=1;s<=o;s++)c.append('<li class="page-item '+(s==x?"active":"")+'" ><a class="page-link" href="#" forPage="'+s+'">'+s+"</a></li>");i.empty().append(c);var l=100*(x-1),u=Math.min(l+100,n.length),p=n.slice(l,u),d="<ul id='itemsTable' class='baseTableShop'>";d+=S({name:"Tên",index:"ID",isFirstRow:!0,code:"ID",__type:"Loại",level:"Cấp",spr:"Hình",script:"Script",kind:"NH"}),p.forEach((function(t,e){var n=b.data.allItems[t];d+=S(n)})),d+="</ul>",w.empty().append($(d)),document.querySelectorAll('[data-bs-toggle="popover"]').forEach((function(t){t.hasAttribute("data-bs-popover-initialized")||(t.setAttribute("data-bs-popover-initialized","true"),new bootstrap.Popover(t),t.addEventListener("shown.bs.popover",(function(){var e=bootstrap.Popover.getInstance(t);setTimeout((function(){e.hide()}),2e3)})))}))}};const O=I;function k(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}var N=n(384),L=N.toUnicode,A=N.toTCVN3;const P={t2u:function(t){return L(t,"tcvn3")},u2t:function(t){return A(t,"unicode")},getFileName:function(t){var e=t.split(/[\\/]/);return e[e.length-1]},parseCSVRow:function(t){return t.split("\t").map((function(t){var e=parseFloat(t);return isNaN(e)||String(e)!==t?"true"===t||"false"===t?"true"===t:t:e}))},arrayToCSV:function(t){var e,n=Math.max.apply(Math,function(t){if(Array.isArray(t))return k(t)}(e=t.map((function(t){return t.length})))||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(e)||function(t,e){if(t){if("string"==typeof t)return k(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?k(t,e):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());return t.map((function(t){for(;t.length<n;)t.push("");return t})).map((function(t){return t.join("\t")})).join("\r\n")}},j=(String.fromCharCode,new Map([[129,1],[141,13],[143,15],[144,16],[157,29],[160,32],[161,33],[162,34],[163,35],[164,36],[165,37],[166,38],[167,39],[168,40],[169,41],[170,42],[171,43],[172,44],[173,45],[174,46],[175,47],[176,48],[177,49],[178,50],[179,51],[180,52],[181,53],[182,54],[183,55],[184,56],[185,57],[186,58],[187,59],[188,60],[189,61],[190,62],[191,63],[192,64],[193,65],[194,66],[195,67],[196,68],[197,69],[198,70],[199,71],[200,72],[201,73],[202,74],[203,75],[204,76],[205,77],[206,78],[207,79],[208,80],[209,81],[210,82],[211,83],[212,84],[213,85],[214,86],[215,87],[216,88],[217,89],[218,90],[219,91],[220,92],[221,93],[222,94],[223,95],[224,96],[225,97],[226,98],[227,99],[228,100],[229,101],[230,102],[231,103],[232,104],[233,105],[234,106],[235,107],[236,108],[237,109],[238,110],[239,111],[240,112],[241,113],[242,114],[243,115],[244,116],[245,117],[246,118],[247,119],[248,120],[249,121],[250,122],[251,123],[252,124],[253,125],[254,126],[255,127],[338,12],[339,28],[352,10],[353,26],[376,31],[381,14],[382,30],[402,3],[710,8],[732,24],[8211,22],[8212,23],[8216,17],[8217,18],[8218,2],[8220,19],[8221,20],[8222,4],[8224,6],[8225,7],[8226,21],[8230,5],[8240,9],[8249,11],[8250,27],[8364,0],[8482,25]])),F=(new Map([[0,"€"],[1,""],[2,"‚"],[3,"ƒ"],[4,"„"],[5,"…"],[6,"†"],[7,"‡"],[8,"ˆ"],[9,"‰"],[10,"Š"],[11,"‹"],[12,"Œ"],[13,""],[14,"Ž"],[15,""],[16,""],[17,"‘"],[18,"’"],[19,"“"],[20,"”"],[21,"•"],[22,"–"],[23,"—"],[24,"˜"],[25,"™"],[26,"š"],[27,"›"],[28,"œ"],[29,""],[30,"ž"],[31,"Ÿ"],[32," "],[33,"¡"],[34,"¢"],[35,"£"],[36,"¤"],[37,"¥"],[38,"¦"],[39,"§"],[40,"¨"],[41,"©"],[42,"ª"],[43,"«"],[44,"¬"],[45,"­"],[46,"®"],[47,"¯"],[48,"°"],[49,"±"],[50,"²"],[51,"³"],[52,"´"],[53,"µ"],[54,"¶"],[55,"·"],[56,"¸"],[57,"¹"],[58,"º"],[59,"»"],[60,"¼"],[61,"½"],[62,"¾"],[63,"¿"],[64,"À"],[65,"Á"],[66,"Â"],[67,"Ã"],[68,"Ä"],[69,"Å"],[70,"Æ"],[71,"Ç"],[72,"È"],[73,"É"],[74,"Ê"],[75,"Ë"],[76,"Ì"],[77,"Í"],[78,"Î"],[79,"Ï"],[80,"Ð"],[81,"Ñ"],[82,"Ò"],[83,"Ó"],[84,"Ô"],[85,"Õ"],[86,"Ö"],[87,"×"],[88,"Ø"],[89,"Ù"],[90,"Ú"],[91,"Û"],[92,"Ü"],[93,"Ý"],[94,"Þ"],[95,"ß"],[96,"à"],[97,"á"],[98,"â"],[99,"ã"],[100,"ä"],[101,"å"],[102,"æ"],[103,"ç"],[104,"è"],[105,"é"],[106,"ê"],[107,"ë"],[108,"ì"],[109,"í"],[110,"î"],[111,"ï"],[112,"ð"],[113,"ñ"],[114,"ò"],[115,"ó"],[116,"ô"],[117,"õ"],[118,"ö"],[119,"÷"],[120,"ø"],[121,"ù"],[122,"ú"],[123,"û"],[124,"ü"],[125,"ý"],[126,"þ"],[127,"ÿ"]]),t=>{if("replacement"===t)return 65533;throw new Error});function R(t){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},R(t)}function M(){M=function(){return e};var t,e={},n=Object.prototype,a=n.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function l(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,n){return t[e]=n}}function u(t,e,n,a){var o=e&&e.prototype instanceof m?e:m,i=Object.create(o.prototype),c=new $(a||[]);return r(i,"_invoke",{value:T(t,n,c)}),i}function p(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var d="suspendedStart",f="suspendedYield",h="executing",g="completed",v={};function m(){}function y(){}function b(){}var w={};l(w,i,(function(){return this}));var x=Object.getPrototypeOf,D=x&&x(x(_([])));D&&D!==n&&a.call(D,i)&&(w=D);var E=b.prototype=m.prototype=Object.create(w);function C(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function n(r,o,i,c){var s=p(t[r],t,o);if("throw"!==s.type){var l=s.arg,u=l.value;return u&&"object"==R(u)&&a.call(u,"__await")?e.resolve(u.__await).then((function(t){n("next",t,i,c)}),(function(t){n("throw",t,i,c)})):e.resolve(u).then((function(t){l.value=t,i(l)}),(function(t){return n("throw",t,i,c)}))}c(s.arg)}var o;r(this,"_invoke",{value:function(t,a){function r(){return new e((function(e,r){n(t,a,e,r)}))}return o=o?o.then(r,r):r()}})}function T(e,n,a){var r=d;return function(o,i){if(r===h)throw new Error("Generator is already running");if(r===g){if("throw"===o)throw i;return{value:t,done:!0}}for(a.method=o,a.arg=i;;){var c=a.delegate;if(c){var s=I(c,a);if(s){if(s===v)continue;return s}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(r===d)throw r=g,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);r=h;var l=p(e,n,a);if("normal"===l.type){if(r=a.done?g:f,l.arg===v)continue;return{value:l.arg,done:a.done}}"throw"===l.type&&(r=g,a.method="throw",a.arg=l.arg)}}}function I(e,n){var a=n.method,r=e.iterator[a];if(r===t)return n.delegate=null,"throw"===a&&e.iterator.return&&(n.method="return",n.arg=t,I(e,n),"throw"===n.method)||"return"!==a&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+a+"' method")),v;var o=p(r,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,v;var i=o.arg;return i?i.done?(n[e.resultName]=i.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,v):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function $(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function _(e){if(e||""===e){var n=e[i];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function n(){for(;++r<e.length;)if(a.call(e,r))return n.value=e[r],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(R(e)+" is not iterable")}return y.prototype=b,r(E,"constructor",{value:b,configurable:!0}),r(b,"constructor",{value:y,configurable:!0}),y.displayName=l(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,l(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},C(S.prototype),l(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,n,a,r,o){void 0===o&&(o=Promise);var i=new S(u(t,n,a,r),o);return e.isGeneratorFunction(n)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},C(E),l(E,s,"Generator"),l(E,i,(function(){return this})),l(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var a in e)n.push(a);return n.reverse(),function t(){for(;n.length;){var a=n.pop();if(a in e)return t.value=a,t.done=!1,t}return t.done=!0,t}},e.values=_,$.prototype={constructor:$,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var n in this)"t"===n.charAt(0)&&a.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(a,r){return c.type="throw",c.arg=e,n.next=a,r&&(n.method="next",n.arg=t),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],c=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=a.call(i,"catchLoc"),l=a.call(i,"finallyLoc");if(s&&l){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&a.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),k(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var a=n.completion;if("throw"===a.type){var r=a.arg;k(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,a){return this.delegate={iterator:_(e),resultName:n,nextLoc:a},"next"===this.method&&(this.arg=t),v}},e}function G(t,e,n,a,r,o,i){try{var c=t[o](i),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(a,r)}function V(t){return function(){var e=this,n=arguments;return new Promise((function(a,r){var o=t.apply(e,n);function i(t){G(o,a,r,i,c,"next",t)}function c(t){G(o,a,r,i,c,"throw",t)}i(void 0)}))}}var B,U,J,K,q;const Y={init:function(){(B=new Dexie("FriendDatabase")).version(2).stores({files:"&fName,fContent"})},save:(q=V(M().mark((function t(e,n){return M().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log(e,n),t.prev=1,t.next=4,B.files.get({fName:e});case 4:if(!t.sent){t.next=11;break}return t.next=8,B.files.update(e,{fContent:n});case 8:console.log("Updated record for ".concat(e)),t.next=14;break;case 11:return t.next=13,B.files.add({fName:e,fContent:n});case 13:console.log("Created record for ".concat(e));case 14:t.next=19;break;case 16:t.prev=16,t.t0=t.catch(1),console.error("Error updating/creating record: ".concat(t.t0));case 19:case"end":return t.stop()}}),t,null,[[1,16]])}))),function(t,e){return q.apply(this,arguments)}),get:(K=V(M().mark((function t(e){var n;return M().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,B.files.get({fName:e});case 3:if(!(n=t.sent)){t.next=8;break}return t.abrupt("return",n.fContent);case 8:return console.log("File with name '".concat(e,"' not found.")),t.abrupt("return",null);case 10:t.next=16;break;case 12:return t.prev=12,t.t0=t.catch(0),console.error("Error retrieving content: ".concat(t.t0)),t.abrupt("return",null);case 16:case"end":return t.stop()}}),t,null,[[0,12]])}))),function(t){return K.apply(this,arguments)}),remove:(J=V(M().mark((function t(e){return M().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,B.files.get({fName:e});case 3:if(!t.sent){t.next=10;break}return t.next=7,B.files.delete(e);case 7:console.log("Deleted record with file name '".concat(e,"'.")),t.next=11;break;case 10:console.log("File with name '".concat(e,"' not found. No records deleted."));case 11:t.next=16;break;case 13:t.prev=13,t.t0=t.catch(0),console.error("Error deleting record: ".concat(t.t0));case 16:case"end":return t.stop()}}),t,null,[[0,13]])}))),function(t){return J.apply(this,arguments)}),getAll:(U=V(M().mark((function t(){var e;return M().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,B.files.toArray();case 3:return e=t.sent,t.abrupt("return",e);case 7:return t.prev=7,t.t0=t.catch(0),console.error("Error retrieving all files: ".concat(t.t0)),t.abrupt("return",[]);case 11:case"end":return t.stop()}}),t,null,[[0,7]])}))),function(){return U.apply(this,arguments)})};function H(t){return H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},H(t)}function Z(){Z=function(){return e};var t,e={},n=Object.prototype,a=n.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function l(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,n){return t[e]=n}}function u(t,e,n,a){var o=e&&e.prototype instanceof m?e:m,i=Object.create(o.prototype),c=new $(a||[]);return r(i,"_invoke",{value:T(t,n,c)}),i}function p(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var d="suspendedStart",f="suspendedYield",h="executing",g="completed",v={};function m(){}function y(){}function b(){}var w={};l(w,i,(function(){return this}));var x=Object.getPrototypeOf,D=x&&x(x(_([])));D&&D!==n&&a.call(D,i)&&(w=D);var E=b.prototype=m.prototype=Object.create(w);function C(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function n(r,o,i,c){var s=p(t[r],t,o);if("throw"!==s.type){var l=s.arg,u=l.value;return u&&"object"==H(u)&&a.call(u,"__await")?e.resolve(u.__await).then((function(t){n("next",t,i,c)}),(function(t){n("throw",t,i,c)})):e.resolve(u).then((function(t){l.value=t,i(l)}),(function(t){return n("throw",t,i,c)}))}c(s.arg)}var o;r(this,"_invoke",{value:function(t,a){function r(){return new e((function(e,r){n(t,a,e,r)}))}return o=o?o.then(r,r):r()}})}function T(e,n,a){var r=d;return function(o,i){if(r===h)throw new Error("Generator is already running");if(r===g){if("throw"===o)throw i;return{value:t,done:!0}}for(a.method=o,a.arg=i;;){var c=a.delegate;if(c){var s=I(c,a);if(s){if(s===v)continue;return s}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(r===d)throw r=g,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);r=h;var l=p(e,n,a);if("normal"===l.type){if(r=a.done?g:f,l.arg===v)continue;return{value:l.arg,done:a.done}}"throw"===l.type&&(r=g,a.method="throw",a.arg=l.arg)}}}function I(e,n){var a=n.method,r=e.iterator[a];if(r===t)return n.delegate=null,"throw"===a&&e.iterator.return&&(n.method="return",n.arg=t,I(e,n),"throw"===n.method)||"return"!==a&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+a+"' method")),v;var o=p(r,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,v;var i=o.arg;return i?i.done?(n[e.resultName]=i.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,v):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function $(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function _(e){if(e||""===e){var n=e[i];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function n(){for(;++r<e.length;)if(a.call(e,r))return n.value=e[r],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(H(e)+" is not iterable")}return y.prototype=b,r(E,"constructor",{value:b,configurable:!0}),r(b,"constructor",{value:y,configurable:!0}),y.displayName=l(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,l(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},C(S.prototype),l(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,n,a,r,o){void 0===o&&(o=Promise);var i=new S(u(t,n,a,r),o);return e.isGeneratorFunction(n)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},C(E),l(E,s,"Generator"),l(E,i,(function(){return this})),l(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var a in e)n.push(a);return n.reverse(),function t(){for(;n.length;){var a=n.pop();if(a in e)return t.value=a,t.done=!1,t}return t.done=!0,t}},e.values=_,$.prototype={constructor:$,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var n in this)"t"===n.charAt(0)&&a.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(a,r){return c.type="throw",c.arg=e,n.next=a,r&&(n.method="next",n.arg=t),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],c=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=a.call(i,"catchLoc"),l=a.call(i,"finallyLoc");if(s&&l){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&a.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),k(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var a=n.completion;if("throw"===a.type){var r=a.arg;k(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,a){return this.delegate={iterator:_(e),resultName:n,nextLoc:a},"next"===this.method&&(this.arg=t),v}},e}function z(t,e,n,a,r,o,i){try{var c=t[o](i),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(a,r)}function Q(t){return function(){var e=this,n=arguments;return new Promise((function(a,r){var o=t.apply(e,n);function i(t){z(o,a,r,i,c,"next",t)}function c(t){z(o,a,r,i,c,"throw",t)}i(void 0)}))}}var X,W,tt=function(){var t=Q(Z().mark((function t(e,n){var a,r,o,i,c,s,l,u;return Z().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=$("#readProgressBar .progress-bar"),r=new JSZip,t.next=4,r.loadAsync(e);case 4:return o=new TextDecoder("windows-1252"),i=[],c=0,s=0,r.forEach((function(t,e){s++})),l={},u=["goldequip","platinaequip"],(u=Object.keys(E)).push("buysell"),u.push("goods"),r.forEach((function(t,e){if(t.endsWith(".txt")){if(0===u.filter((function(e){return-1!==t.indexOf(e)})).length)return void c++;var n=e.async("arraybuffer").then((function(e){var n=o.decode(e);if(-1===t.indexOf("goods")&&-1===t.indexOf("buysell")&&-1===n.indexOf("ItemGenre"))return c++,!0;l[t]=n.split(/\r?\n/).filter(Boolean),c++;var r=Math.floor(100*c/s);a.css("width",r+"%").text(r+"%").closest("div").attr("aria-valuenow",r)}));i.push(n)}else c++})),t.next=16,Promise.all(i);case 16:a.css("width","0").text(""),n(l);case 18:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),et={patchGoodsTxt:function(t){var e=0;if($.each(t,(function(t,n){n.length>20?e++:e--})),e<t.length/2){var n=[];return $.each(t.slice(),(function(t,e){var a=Array(27).fill("");a[0]=e[0],a[1]=e[1],a[2]=e[2],a[3]=e[3],a[4]=e[4],a[6]=e[5],a[7]=e[6],a[8]=e[7],a[9]=e[8],a[10]=e[9],a[25]=e[10],a[12]=e[11],a[13]=e[12],a[14]=e[13],a[22]=e[14],a[23]=e[15],a[26]=e[16],n.push(a)})),b.data.goodsData=n,!0}return!1},undoPatchGoodsTxt:function(t){var e=[];return $.each(t,(function(t,n){var a=Array(17).fill("");a[0]=n[0],a[1]=n[1],a[2]=n[2],a[3]=n[3],a[4]=n[4],a[5]=n[6],a[6]=n[7],a[7]=n[8],a[8]=n[9],a[9]=n[10],a[10]=n[25],a[11]=n[12],a[12]=n[13],a[13]=n[14],a[14]=n[22],a[15]=n[23],a[16]=n[26],e.push(a)})),e},patchBuySellTxt:function(t){var e=0;return $.each(t,(function(t,n){"string"==typeof n[0]?e++:e--})),e<t.length/2&&(t=t.map((function(t,e){return 0===e?t.unshift("Name"):t.unshift(""),t})),b.data.buysellData=t,!0)},undoPatchBuySellTxt:function(t){return t.slice().map((function(t){return t.shift(),t}))}};const nt={fileManager:{readZipFileFromURL:(W=Q(Z().mark((function t(e,n){var a;return Z().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(e);case 2:if((a=t.sent).ok){t.next=5;break}throw new Error("Failed to fetch the ZIP file (HTTP status: ".concat(a.status,")."));case 5:tt(a.arrayBuffer(),n);case 6:case"end":return t.stop()}}),t)}))),function(t,e){return W.apply(this,arguments)}),readZipFileFromLocal:(X=Q(Z().mark((function t(e,n){var a;return Z().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(a=new FileReader).onload=function(t){var e=t.target.result;tt(e,n)},a.readAsArrayBuffer(e);case 3:case"end":return t.stop()}}),t)}))),function(t,e){return X.apply(this,arguments)}),save2File:function(t,e){var n,a=function(t){t=((t,e)=>{let n;e&&e.mode&&(n=e.mode.toLowerCase()),"fatal"!==n&&"replacement"!==n&&(n="fatal");const a=t.length,r=new Uint16Array(a);for(let e=0;e<a;e++){const a=t.charCodeAt(e);if(0<=a&&a<=127)r[e]=a;else if(j.has(a)){const t=j.get(a);r[e]=t+128}else r[e]=F(n)}return r})(t,{mode:"replacement"});var e=new Uint8Array([129,141,143,144,157]),n=new Uint8Array(e.length+t.length);return n.set(e,0),n.set(t,e.length),n}(e);n=new Blob([a],{type:"text/csv;charset=windows-1252"});var r=URL.createObjectURL(n),o=document.createElement("a");o.href=r,o.download=t,o.click(),URL.revokeObjectURL(r)}},helpers:P,vConverter:et,db:Y};var at=n(507),rt={};rt.styleTagTransform=d(),rt.setAttributes=s(),rt.insert=i().bind(null,"head"),rt.domAPI=r(),rt.insertStyleElement=u(),e()(at.Z,rt),at.Z&&at.Z.locals&&at.Z.locals;var ot,it,ct={6:"Tiền",7:"P Duyên",8:"Xu",9:"Điểm TK",10:"Vinh Dự",11:"Cống hiến",12:"Danh vọng",13:"Điểm CT"},st=nt.helpers.u2t("(Chưa có tên)"),lt=function(t,e){var n=e[26]?""+e[26]:"",a=[e[0],e[1],e[2]||0,e[3]||0,e[4]||0].join("_");return b.data.allItems&&b.data.allItems[a]&&(n=b.data.allItems[a].name),""===$.trim(n)&&(n=st+" "+a),{name:n,index:t,data:e,code:a,type:b.data.allItems&&b.data.allItems[a]?b.data.allItems[a].__type:"others"}},ut=function(t){var e=t.isFirstRow?t.name:nt.helpers.t2u(t.name),n="<li class='dataRow isEditing ".concat(pt[t.index]?"isChanged":"","' forID='").concat(t.index,"'>");return n+='\n\t\n\t\t<span class="colChose" title="Thêm vào buysell.txt">\n\t\t\t'.concat(t.isFirstRow?"Thêm":'<button class=\'btn btn-primary btn-sm add2BuySell\' data-bs-container="body" data-bs-toggle="popover" data-bs-placement="top" data-bs-content="Đã thêm vào buysell.txt">+</button>','\n\t\t</span>\n\t\t\n        <span class="colID" title=\'').concat(t.index," (").concat(t.code,")'>\n            ").concat(t.index,'\n        </span>\n        <span class="colName"> \n            ')+(t.isFirstRow?e:'\n            <span class="colEdit">\n                <select class="searchItem" forID=\''.concat(t.index,"'>\n                    <option value=\"").concat(t.code,'">').concat(e,"</option>                \n                </select>\n            </span>\n            "))+"\n        </span>\n\t\t\n\n    ",t.shopCounter&&(n+='\n\n        <span class="colShopCounter" title=\''.concat(t.isFirstRow?"":t.shopCounter.join(","),"'>\n            ").concat(t.isFirstRow?"SD":t.shopCounter.length,"\n        </span>\n        ")),n+='\n\n        <span class="colShopCounter" title=\''.concat(t.isFirstRow?"Ngũ Hành":t.kind,"'>\n            ").concat(t.isFirstRow?"NH":t.data[3],'\n        </span>\n\t\t\n        <span class="colShopCounter" title=\'').concat(t.isFirstRow?"Cấp":t.level,"'>\n            ").concat(t.isFirstRow?"Cấp":t.data[4],"\n        </span>\n        "),$.each(ct,(function(e,a){n+='                \n        <span class="colData '.concat((t.isFirstRow,""),'" forColumn="').concat(e,'">\n        ').concat(t.isFirstRow?ct[e]:'\n            <span class="colDisplay">'.concat(t.isFirstRow?ct[e]:t.data[e],'</span>\n            <input class="colEdit" type="number" value="').concat(t.data[e],'"/>\n            '),"\n        </span>")})),n+='<span class="controllerTool">\n        '.concat(t.isFirstRow?"":"<button class='btn btn-secondary btn-sm cancelEditGood'>Phục Hồi</button> <button class='btn btn-danger btn-sm deleteGood'>Xóa</button>","\n    </span>"),n+="</li>"},pt={},dt=!1,ft={show:function(t,e){if(t&&(ot=t),e&&(it=e),function(t){if(!dt){dt=!0,$("#goodsEditorPagination").on("click",".page-link",(function(e){e.preventDefault(),e.stopPropagation(),ft.show(t,$(this).attr("forPage"))}));var e=_.debounce((function(){ft.show(!1,1)}),1e3);$("#filterGoodByName").keyup(e),t.on("click",".controllerTool .cancelEditGood",(function(t){t.preventDefault(),t.stopPropagation();var e=$(this).closest(".dataRow").attr("forID");b.data.goodsData[e]=JSON.parse(JSON.stringify(pt[e])),delete pt[e],ft.show()})),t.on("click",".controllerTool .deleteGood",(function(e){e.preventDefault(),e.stopPropagation();var n=$(this).closest(".dataRow").attr("forID");b.data.goodsData.splice(n,1),b.data.buysellData.forEach((function(t,e){if(0==e)return!0;if(t.length<=1)return!0;var a=!1;(t=t.filter((function(t,e){return!(e>0&&t===n&&(a=!0,1))}))).forEach((function(e,r){r>0&&e>n&&(t[r]=e-1,a=!0)})),a&&(b.data.buysellData[e]=t)})),ft.show(t,it),Et.show()}));var n=$("#addNewItemToGoodInp");n.select2($.extend({},window.llGlobal,{ajax:{delay:500,cache:!0,url:function(t){return""},processResults:function(t,e){var n=e.term,a=[];return""!==n&&(n=nt.helpers.u2t(n).toLowerCase(),$.each(b.data.allItemsKey,(function(t,e){var r=b.data.allItems[e];-1!==b.getSearchToken(e,r).indexOf(n)&&a.push({text:nt.helpers.t2u(r.name)+" ("+e.replace(/_/g," ")+" "+r.__type+")",id:e})}))),{results:a}}}})),n.on("select2:select",(function(t){var e=t.params.data,n=Array(b.data.goodsData[b.data.goodsData.length-1].length).fill(""),a=JSON.parse(JSON.stringify(b.data.allItems[e.id]));n[26]=a.name,n[0]=a.genre,n[1]=a.type,n[2]=a.spec,n[3]=a.kind,n[4]=a.level,b.data.goodsData.push(n),ft.show(),llEvents.trigger("buysellData.changed")})),t.on("blur",".colEdit[type='number']",(function(t){var e=parseInt($(this).closest(".colData").attr("forColumn"),10),n=parseInt($(this).val(),10),a=parseInt($(this).closest(".dataRow").attr("forID"),10);b.data.goodsData[a][e]=n})),llEvents.on("goodsData.changed",_.debounce((function(){ft.show()}),1e3)),$("#buysellSelection").change((function(){var t=$(this).val(),e=$(this).find('option[value="'+t+'"]');$(".add2BuySell").attr("data-bs-content","Đã thêm vào "+e.text()),$(".add2BuySell").closest(".colChose").attr("title","Thêm vào "+e.text())})),t.on("click",".add2BuySell",(function(){var t=$(this).closest(".dataRow"),e=parseInt(t.attr("forID"),10),n=$("#buysellSelection").val();if(b.data.buysellData[n]){var a=!1;$.each(b.data.buysellData[n],(function(t,r){if(t>0&&(""==r||!r))return b.data.buysellData[n][t]=e,a=!0,!1})),a||b.data.buysellData[n].push(e)}t.addClass("flash-row"),llEvents.trigger("buysellData.changed")}))}}(ot),b.data.goodsData){var n=JSON.parse(JSON.stringify(b.data.goodsData)),a=b.data.goodsData.length,r=n.shift();n.reverse();var o=[];n.forEach((function(t,e){var n=a-e-1,r=lt(n,t);b.data.goodsData[n][26]=r.name,o.push(r)}));var i=$("#filterGoodByName").val(),c=[];if(""!==i&&(i=nt.helpers.u2t(i),$.each(o,(function(t,e){e.name&&-1!==e.name.toLowerCase().indexOf(i.toLowerCase())&&c.push(e)})),o=c),ot.empty(),!o||0===o.length)return!0;var s=Math.ceil(o.length/100);it||(it=1);for(var l=$("#goodsEditorPagination"),u=$('<ul class="pagination"></ul>'),p=1;p<=s;p++)u.append('<li class="page-item '+(p==it?"active":"")+'" ><a class="page-link" href="#" forPage="'+p+'">'+(s-p+1)+"</a></li>");l.empty().append(u);var d=100*(it-1),f=Math.min(d+100,o.length),h=o.slice(d,f),g="<ul id='goodsTable' class='baseTableShop'>";g+=ut({name:"Tên",index:"ID",data:r,isFirstRow:!0,id:"ID",shopCounter:[]}),h.forEach((function(t,e){var n=JSON.parse(JSON.stringify(t));n.shopCounter=[],$.each(b.data.buysellData,(function(e,a){a.indexOf(t.index)>0&&n.shopCounter.push(e)})),g+=ut(n)})),g+="</ul>",ot.html(g),ot.find(".searchItem").select2($.extend({},window.llGlobal,{ajax:{delay:50,cache:!0,url:function(t){return""},processResults:function(t,e){var n=e.term,a=[];return""!==n&&$.each(b.data.allItemsKey,(function(t,e){var r=b.data.allItems[e];-1!==(e.replace(/_/g," ")+r.name+r.spr).toLowerCase().indexOf(n.toLowerCase())&&a.push({text:r.name+" ("+e.replace(/_/g," ")+" "+r.__type+")",id:e})})),{results:a}}}})),ot.find(".searchItem").on("select2:select",(function(t){var e=t.params.data;!function(t,e){void 0===pt[t]&&(pt[t]=JSON.parse(JSON.stringify(b.data.goodsData[t])));var n=b.data.allItems[e];b.data.goodsData[t][26]=n.name,b.data.goodsData[t][0]=n.genre,b.data.goodsData[t][1]=n.type,b.data.goodsData[t][2]=n.spec,b.data.goodsData[t][3]=n.kind,b.data.goodsData[t][4]=n.level,ft.show(),llEvents.trigger("buysellData.changed")}($(this).attr("forID"),e.id)}))}}};const ht=ft;var gt,vt,mt,yt,bt=function(t){if(b.data.buysellData[vt]){var e=!1;$.each(b.data.buysellData[vt],(function(n,a){if(n>0&&(""==a||!a))return b.data.buysellData[vt][n]=t,e=!0,!1})),e||b.data.buysellData[vt].push(t)}},wt=!1,xt=function(){mt.empty(),yt.empty();var t="";b.data.buysellData&&b.data.buysellData.forEach((function(e,n){if(0==n)return!0;if(e.length<=1)return!0;var a=nt.helpers.t2u(""+e[0]);mt.append('<option value="'.concat(n,'">CH ').concat(n," - ").concat(a,"</option>")),yt.append('<option value="'.concat(n,'">CH ').concat(n," - ").concat(a,"</option>")),t=n})),mt.val(t).change(),yt.val(t).change()},Dt={init:function(t){t&&(gt=t),mt=$("#shopSelect"),yt=$("#buysellSelection"),function(){if(!wt){wt=!0,llEvents.on("buysellData.changed",_.debounce((function(){Dt.show(),xt()}),1e3)),mt.change((function(){var t=$(this).val(),e=$(this).find('option[value="'+t+'"]');$("#selectedShopName").text(e.text()),Dt.show(t)})),$("#createNewShop").click((function(){var t=$("#createNewShopInp").val();b.data.buysellData.push([t]);var e=b.data.buysellData.length-1;mt.append('<option value="'.concat(e,'">Shop ').concat(e," - ").concat(t,"</option>")),mt.val(e).change(),yt.append('<option value="'.concat(e,'">Shop ').concat(e," - ").concat(t,"</option>")),yt.val(e).change()})),$("#deleteShop").click((function(){b.data.buysellData.splice(vt,1),vt=!1,xt()})),gt.on("click",".deleteGood",(function(t){t.preventDefault(),t.stopPropagation();var e=parseInt($(this).closest(".dataRow").attr("forID"),10),n=b.data.buysellData[vt],a=e;n.splice(a+1,1),b.data.buysellData[vt]=n,Dt.show(vt)}));var t=$("#addNewGoodToShopInp");t.select2($.extend({},window.llGlobal,{ajax:{delay:500,cache:!0,url:function(t){return""},processResults:function(t,e){var n=e.term,a=[];return""!==n&&(n=nt.helpers.u2t(n),$.each(b.data.goodsData,(function(t,e){if(0===t)return!0;var r=e.slice();-1!==(r.join(" ")+t).toLowerCase().indexOf(n.toLowerCase())&&a.push({text:nt.helpers.t2u(r[26])+" ("+t+") ",id:t})}))),{results:a}}}})),t.on("select2:select",(function(t){var e=t.params.data;bt(e.id),Dt.show()})),$("#addNewGoodToShop").click((function(){var e=t.val();bt(e),Dt.show()}))}}(),xt()},show:function(t){if(gt.empty(),t&&(vt=t),""===t)return!0;if(vt=parseInt(vt),b.data.buysellData&&b.data.buysellData[vt]){var e=b.data.buysellData[vt].slice();e.shift(),e=e.filter((function(t){return t&&""!=t}));var n="<ul id='buysellTable' class='baseTableShop'>";n+=ut({name:"Tên",index:"ID",data:[],isFirstRow:!0,id:"ID"}),e.forEach((function(t,e){var a=lt(e,b.data.goodsData[t]);if(!a)return!0;b.data.goodsData[t][26]=a.name;var r=JSON.parse(JSON.stringify(a));r.name=r.name+" ("+t+")",n+=ut(r)})),n+="</ul>",gt.html(n);var a=gt.find("ul");a.sortable({update:function(t,e){var n;n=[],a.find("li").each((function(){var t=$(this).attr("forId");if("ID"===t)return n.push(b.data.buysellData[vt][0]),!0;n.push(b.data.buysellData[vt][parseInt(t,10)+1])})),b.data.buysellData[vt]=n,Dt.show()}}),gt.find(".searchItem").select2($.extend({},llGlobal,{ajax:{delay:500,cache:!0,url:function(t){return""},processResults:function(t,e){var n=e.term,a=[];return""!==n&&(n=nt.helpers.u2t(n),$.each(b.data.goodsData,(function(t,e){if(0===t)return!0;var r=e.slice();-1!==r.join(" ").toLowerCase().indexOf(n.toLowerCase())&&a.push({text:nt.helpers.t2u(r[26])+" ("+t+") ",id:t})}))),{results:a}}}})),gt.find(".searchItem").on("select2:select",(function(t){var e,n,a=t.params.data;e=$(this).attr("forID"),n=a.id,e=parseInt(e,10),n=parseInt(n,10),b.data.buysellData[vt][e+1]=n,b.data.buysellData[vt]=b.data.buysellData[vt].map((function(t,e){if(0==e)return t;try{return(t=parseInt(t,10))>0?t:""}catch(t){return""}})),Dt.show()}))}}};const Et=Dt;var Ct,St=1,Tt=["","Tên vật phẩm","Genre","Type","Spec","Hình","Tác dụng trong hành trang","Chiều ngang hình","Chiều dọc hình","Mô tả","HDSD","Giá bán vào shop","?","SL nhỏ trong hành trang","LUA script","Hiệu ứng","Có thể vứt","Thông báo","?","Có thể bỏ vào phím tắt","?","SL Xếp chồng","Level nv sử dụng"],It=function(t){return[t[1],t[2],t[3]||0,t[9]||0,t[11]||0].join("_")},Ot=function(t,e){var n=t.shift(),a=It(t),r="<li class='dataRow isEditing ".concat(-1===e?"firstRow":"","' forID='").concat(n,"' forCode='").concat(a,"'>");return r+=' \n        <span class="colChose" title="Thêm vào danh sách vật phẩm bán (goods.txt)">\n            '.concat(-1===e?"":'<button class=\'btn btn-primary btn-sm add2Goods\' data-bs-container="body" data-bs-toggle="popover" data-bs-placement="top" data-bs-content="Đã thêm vào ds vật phẩm bán (goods.txt)">+</button>','\n        </span>\n        <span class="rowData" title="').concat(a,'">').concat(n,"</span>\n    "),$.each(t,(function(t,n){if(t>21)return!1;if(-1===e){var a=String.fromCharCode(65+t)||"";r+='<span class="rowData" forCol="'.concat(t,'" title="').concat(Tt[t],'">\n                \n                ').concat(n,"<br/>\n                <b>").concat(a,"</b>\n            </span>")}else{if(-1!==[1].indexOf(t))return r+='\n                <span class="rowData '.concat(-1!==[0,4,8,13].indexOf(t)?"isText":"isNumber",'" forCol="').concat(t,'">\n                    ').concat(n,"\n                </span>"),!0;-1!==[0,4,8].indexOf(t)&&(n=he.escape(nt.helpers.t2u(n))),r+='\n            <span class="rowData '.concat(-1!==[0,4,8,13].indexOf(t)?"isText":"isNumber",'" forCol="').concat(t,'" title="').concat(Tt[t],'">\n                <input class="form-control" type="text" forCol="').concat(t,'" value="').concat(n,'"/>\n            </span>')}})),r+='<span class="controllerTool">\n        '.concat(-1===e?"":"<button class='btn btn-secondary btn-sm cancelEditGood'>Phục Hồi</button> <button class='btn btn-danger btn-sm deleteMSItem'>Xóa</button>","\n    </span>"),r+="</li>"},kt=!1,$t={show:function(t,e){t&&(Ct=t),e&&(St=e),function(){if(!kt){kt=!0,$("#magicscriptEditorPagination").on("click",".page-link",(function(t){t.preventDefault(),t.stopPropagation(),$t.show(!1,$(this).attr("forPage"))}));var t=_.debounce((function(){$t.show(!1,1)}),1e3);$("#magicscript-tab-pane").on("keyup","#filterMagicscriptByName",t),Ct.on("click",".add2Goods",(function(){var t=$(this).closest(".dataRow"),e=t.attr("forCode"),n=Array(b.data.goodsData[b.data.goodsData.length-1].length).fill(""),a=JSON.parse(JSON.stringify(b.data.allItems[e]));n[26]=a.name,n[0]=a.genre,n[1]=a.type,n[2]=a.spec,n[3]=a.kind,n[4]=a.level,t.addClass("flash-row"),b.data.goodsData.push(n),llEvents.trigger("goodsData.changed")})),Ct.on("click",".controllerTool .deleteMSItem",(function(t){t.preventDefault(),t.stopPropagation();var e=$(this).closest(".dataRow").attr("forID"),n=$(this).closest(".dataRow").attr("forCode");delete b.searchCache[n],b.data.magicscript.splice(e,1),delete b.data.allItems[n],b.data.allItemKeysByType.magicscript=b.data.allItemKeysByType.magicscript.filter((function(t){return t!==n})),b.data.allItemsKey=b.data.allItemsKey.filter((function(t){return t!==n})),$t.show(Ct,St)})),$("#addNewMSItem").click((function(t){t.preventDefault(),t.stopPropagation();var e=JSON.parse(JSON.stringify(b.data.magicscript[b.data.magicscript.length-1].slice()));e[0]="",e[3]=e[3]?e[3]+1:0,e[4]="",e[5]="",e[8]="",e[13]="",b.data.magicscript.push(e),llEvents.trigger("magicscript.changed")})),Ct.on("blur",".rowData input",(function(t){var e=parseInt($(this).closest(".rowData").attr("forCol"),10),n=$(this).val(),a=parseInt(n,10);isNaN(a)?-1!==[0,4,8].indexOf(e)&&(n=nt.helpers.u2t(n)):n=a;var r=parseInt($(this).closest(".dataRow").attr("forID"),10);It(b.data.magicscript[r]),b.data.magicscript[r][e]=n,llEvents.trigger("magicscript.changed")})),llEvents.on("dataCache.changed",(function(){setTimeout((function(){$t.show()}),1)}))}}();var n=JSON.parse(JSON.stringify(b.data.magicscript));(n=n.map((function(t,e){return t.unshift(e),t}))).shift(),n.reverse();var a=nt.helpers.u2t($("#filterMagicscriptByName").val());if(""!==a&&(a=a.toLowerCase(),n=n.filter((function(t){var e=[t[2],t[3],t[4]||0,t[10]||0,t[12]||0].join("_");return-1!==b.getSearchToken(e,b.data.allItems[e]).indexOf(a)}))),Ct.empty(),!n)return!0;var r=n.length,o=Math.ceil(r/100);St>o&&(St=o);for(var i=$("#magicscriptEditorPagination"),c=$('<ul class="pagination"></ul>'),s=1;s<=o;s++)c.append('<li class="page-item '+(s==St?"active":"")+'" ><a class="page-link" href="#" forPage="'+s+'">'+(o-s+1)+"</a></li>");i.empty().append(c);var l=100*(St-1),u=Math.min(l+100,n.length),p=n.slice(l,u),d="<ul id='magicscriptTable' class='baseTableShop'>";d+=Ot(JSON.parse(JSON.stringify(Tt)),-1),p.forEach((function(t,e){d+=Ot(t,e)})),d+="</ul>",Ct.empty().append($(d)),document.querySelectorAll('[data-bs-toggle="popover"]').forEach((function(t){t.hasAttribute("data-bs-popover-initialized")||(t.setAttribute("data-bs-popover-initialized","true"),new bootstrap.Popover(t),t.addEventListener("shown.bs.popover",(function(){var e=bootstrap.Popover.getInstance(t);setTimeout((function(){e.hide()}),2e3)})))}))}};const _t=$t;var Nt,Lt=!1;const At=function(){Lt||(Lt=!0,(Nt=$(".cacheManager")).on("click","#cancelCachedMagicScript",(function(t){nt.db.remove("magicscript.txt"),$(".foundMagicscriptTxt").removeClass("isVisible")})),Nt.on("click","#useCachedMagicScript",(function(t){nt.db.get("magicscript.txt").then((function(t){t&&(b.data.magicscript=t,llEvents.trigger("magicscript.changed"),$(".foundMagicscriptTxt").removeClass("isVisible"))}))})),Nt.on("click","#cancelCachedGoods",(function(t){nt.db.remove("goods.txt"),nt.db.remove("buysell.txt"),$(".foundGoodsTxt").removeClass("isVisible")})),Nt.on("click","#useCachedGoods",(function(t){var e=_.debounce((function(){llEvents.trigger("goodsData.changed"),llEvents.trigger("buysellData.changed")}),1e3);nt.db.get("goods.txt").then((function(t){t&&(b.data.goodsData=t,e())})),nt.db.get("buysell.txt").then((function(t){t&&(b.data.buysellData=t,console.log(t),e())})),$(".foundGoodsTxt").removeClass("isVisible")})),nt.db.get("magicscript.txt").then((function(t){t&&Nt.append('\n\n                <div class="cacheFoundContainer foundMagicscriptTxt isVisible alert alert-warning" role="alert">\n                    <p>Tìm thấy file <b>magicscript.txt</b> đã chỉnh sửa trước đó trong bộ nhớ. Sử dụng:</p>\n\n                    <p>\n                        <button class="btn btn-outline-primary btn-sm" type="button" id="cancelCachedMagicScript">magicscript.txt của file zip (mặc định)</button> \n                        <button class="btn btn-outline-primary btn-sm" type="button" id="useCachedMagicScript">magicscript.txt của bộ nhớ</button>\n                    </p>\n                </div>\n                ')})),nt.db.get("goods.txt").then((function(t){t&&Nt.append('\n\n                <div class="cacheFoundContainer foundGoodsTxt isVisible alert alert-warning" role="alert">\n                    <p>Tìm thấy file <b>buysell.txt</b> <b>goods.txt</b> đã chỉnh sửa trước đó trong bộ nhớ. Sử dụng:</p>\n\n                    <p>\n                        <button class="btn btn-outline-primary btn-sm" type="button" id="cancelCachedGoods">buysell.txt goods.txt của file zip (mặc định)</button> \n                        <button class="btn btn-outline-primary btn-sm" type="button" id="useCachedGoods">buysell.txt goods.txt của bộ nhớ</button>\n                    </p>\n                </div>\n                ')})),nt.db.save("goods.txt",b.data.goodsData),nt.db.save("buysell.txt",b.data.buysellData),nt.db.save("magicscript.txt",b.data.magicscript))};var Pt={init:function(t,e){!function(t,e){$("#downloadAllv6").click((function(){nt.db.save("goods.txt",b.data.goodsData),nt.db.save("buysell.txt",b.data.buysellData),nt.fileManager.save2File("goods.txt",nt.helpers.arrayToCSV(nt.vConverter.undoPatchGoodsTxt(b.data.goodsData))),nt.fileManager.save2File("buysell.txt",nt.helpers.arrayToCSV(nt.vConverter.undoPatchBuySellTxt(b.data.buysellData)))})),$("#downloadAllv8").click((function(){nt.db.save("goods.txt",b.data.goodsData),nt.db.save("buysell.txt",b.data.buysellData),nt.fileManager.save2File("goods.txt",nt.helpers.arrayToCSV(b.data.goodsData)),nt.fileManager.save2File("buysell.txt",nt.helpers.arrayToCSV(b.data.buysellData))})),$("#downloadMagicScript").click((function(){nt.db.save("magicscript.txt",b.data.magicscript),nt.fileManager.save2File("magicscript.txt",nt.helpers.arrayToCSV(b.data.magicscript)+"\r\n")})),$("#backHome").click((function(){b.data={},$("#zip004Input").val(""),$("body").removeClass("loadedData")}));var n=document.getElementById("uploadButton"),a=new bootstrap.Popover(n,{placement:"right",content:"Ủa gì dợ ? File đâu?",trigger:"manual"});$("#uploadButton").click((function(){var n=document.getElementById("zip004Input").files[0];n?nt.fileManager.readZipFileFromLocal(n,(function(n){t(n,e)})):(a.show(),setTimeout((function(){a.hide()}),5e3))})),document.getElementById("zip004Input").addEventListener("change",(function(t){_.defer((function(){$("#uploadButton").click()}),1)})),$("#huongdan-tab-pane a[dTarget]").click((function(t){t.preventDefault(),t.stopPropagation();var e=$(this).attr("dTarget");$(e).click()}))}(t,e)},renderBuySellDropdown:function(){Et.init($("#buysellEditor"))},renderItemsViewer:function(){O.show($("#itemViewer"),1)},renderGoodsEditor:function(){ht.show($("#goodsEditor"))},renderMagicScriptEditor:function(){_t.show($("#magicscriptEditor"))},renderDBManager:function(){At()}};const jt=Pt;function Ft(t,e){var n=(t.match(/\//g)||[]).length,a=(e.match(/\//g)||[]).length;return n<a?-1:n>a?1:t.localeCompare(e)}var Rt=function(){b.data.allItems={},b.data.allItemKeysByType={},b.data.allItemsKey=[],$.each(b.data.others,(function(t,e){var n=nt.helpers.getFileName(t).replace(".txt","");"platinaequip"==n&&(n="goldequip");for(var a=0;a<e.length;a++)if(0!=a){var r=e[a];b.addItemToCachePool(n,r,a)}}));for(var t=b.data.magicscript,e=0;e<t.length;e++)if(0!=e){var n=t[e];b.addItemToCachePool("magicscript",n,e)}$.each(b.data.allItems,(function(t,e){var n=e.__type;b.data.allItemKeysByType[n]||(b.data.allItemKeysByType[n]=[]),b.data.allItemKeysByType[n].push(t)}));var a=Object.keys(b.data.allItems);a.sort(),b.data.allItemsKey=a,llEvents.trigger("dataCache.changed")},Mt=function(t){b.data.others={};var e=Object.keys(t);e.sort(Ft);for(var n=0;n<e.length;n++){var a=e[n],r=t[a],o=nt.helpers.getFileName(a).replace(".txt","");if("platinaequip"==o&&(o="goldequip"),"goods"!==o)if("buysell"!==o)if("magicscript"!==o){if(r.length){var i=r[0].toLowerCase();-1!==i.indexOf("itemgenre")&&-1!==i.indexOf("detailtype")&&(b.data.others[a]=r.map(nt.helpers.parseCSVRow))}}else b.data.magicscript=r.map(nt.helpers.parseCSVRow);else b.data.buysellData=r.map(nt.helpers.parseCSVRow),nt.vConverter.patchBuySellTxt(b.data.buysellData)&&(b.v6=!0);else b.data.goodsData=r.map(nt.helpers.parseCSVRow),nt.vConverter.patchGoodsTxt(b.data.goodsData)&&(b.v6=!0)}if(!b.data.goodsData||!b.data.goodsData.length)return!0;Rt()};$(document).ready((function(){$("#pageTitle").text(b.version),$("head title").text(b.version),nt.db.init();var t=!1;llEvents.on("magicscript.changed",(function(){Rt()})),llEvents.on("dataCache.changed",(function(){setTimeout((function(){t||(t=!0,jt.renderItemsViewer(),jt.renderGoodsEditor(),jt.renderBuySellDropdown(),jt.renderMagicScriptEditor(),jt.renderDBManager(),b.isDEV?$("#magicscript-tab").click():$("#goods-txt-tab").click(),$("body").addClass("loadedData"))}),1)})),jt.init(Mt),b.isDEV&&nt.fileManager.readZipFileFromURL("assets/server1.zip",(function(t){Mt(t)}))}))})()})();